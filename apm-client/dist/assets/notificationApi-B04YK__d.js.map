{"version":3,"file":"notificationApi-B04YK__d.js","sources":["../../src/store/api/notificationApi.ts"],"sourcesContent":["// src/store/api/notificationApi.ts\nimport { apiSlice } from './apiSlice';\n\nexport interface Notification {\n  id: string;\n  type: string;\n  title: string;\n  message: string;\n  data: Record<string, any>;\n  isRead: boolean;\n  priority: 'EMERGENCY' | 'HIGH' | 'NORMAL' | 'LOW';\n  createdAt: string;\n  readAt?: string;\n}\n\nexport interface NotificationPreferences {\n  pushEnabled: boolean;\n  emailEnabled: boolean;\n  lifelinksEnabled: boolean;\n  eventsEnabled: boolean;\n  pollsEnabled: boolean;\n  paymentsEnabled: boolean;\n  systemEnabled: boolean;\n  postsEnabled: boolean;\n}\n\n// Inject notification endpoints into the main API slice\nexport const notificationApi = apiSlice.injectEndpoints({\n  endpoints: (builder) => ({\n    // Get user notifications\n    getNotifications: builder.query<{\n      notifications: Notification[];\n      pagination: {\n        page: number;\n        limit: number;\n        total: number;\n        totalPages: number;\n      };\n    }, {\n      page?: number;\n      limit?: number;\n      unreadOnly?: boolean;\n      type?: string;\n    }>({\n      query: (params = {}) => ({\n        url: '/notifications',\n        params,\n      }),\n      transformResponse: (response: any) => response.data,\n      providesTags: ['Notification'],\n    }),\n\n    // Get unread count\n    getUnreadCount: builder.query<{\n      count: number;\n    }, void>({\n      query: () => '/notifications/unread-count',\n      transformResponse: (response: any) => response.data,\n      providesTags: ['Notification', 'UnreadCount'],\n    }),\n\n    // Mark notification as read\n    markAsRead: builder.mutation<{\n      success: boolean;\n      message: string;\n    }, string>({\n      query: (notificationId) => ({\n        url: `/notifications/${notificationId}/read`,\n        method: 'PUT',\n      }),\n      invalidatesTags: ['Notification', 'UnreadCount'],\n    }),\n\n    // Mark all notifications as read\n    markAllAsRead: builder.mutation<{\n      success: boolean;\n      message: string;\n    }, void>({\n      query: () => ({\n        url: '/notifications/mark-all-read',\n        method: 'PUT',\n      }),\n      invalidatesTags: ['Notification', 'UnreadCount'],\n    }),\n\n    // Delete notification\n    deleteNotification: builder.mutation<{\n      success: boolean;\n      message: string;\n    }, string>({\n      query: (notificationId) => ({\n        url: `/notifications/${notificationId}`,\n        method: 'DELETE',\n      }),\n      invalidatesTags: ['Notification', 'UnreadCount'],\n    }),\n\n    // Clear all notifications\n    clearAllNotifications: builder.mutation<{\n      success: boolean;\n      message: string;\n      deletedCount: number;\n    }, void>({\n      query: () => ({\n        url: '/notifications/clear-all',\n        method: 'DELETE',\n      }),\n      invalidatesTags: ['Notification', 'UnreadCount'],\n    }),\n\n    // Get notification preferences\n    getNotificationPreferences: builder.query<NotificationPreferences, void>({\n      query: () => '/notifications/preferences',\n      transformResponse: (response: any) => response.data,\n      providesTags: ['NotificationPreferences'],\n    }),\n\n    // Update notification preferences\n    updateNotificationPreferences: builder.mutation<{\n      success: boolean;\n      preferences: NotificationPreferences;\n    }, Partial<NotificationPreferences>>({\n      query: (preferences) => ({\n        url: '/notifications/preferences',\n        method: 'PUT',\n        body: preferences,\n      }),\n      invalidatesTags: ['NotificationPreferences'],\n    }),\n\n    // Register push notification token\n    registerPushToken: builder.mutation<{\n      success: boolean;\n      message: string;\n    }, {\n      token: string;\n      deviceType: string;\n      deviceId: string;\n    }>({\n      query: (data) => ({\n        url: '/notifications/register-token',\n        method: 'POST',\n        body: data,\n      }),\n    }),\n\n    // Get user push tokens\n    getPushTokens: builder.query<{\n      tokens: Array<{\n        id: string;\n        token: string;\n        deviceType: string;\n        deviceId: string;\n        isActive: boolean;\n        createdAt: string;\n        lastUsed: string;\n      }>;\n    }, void>({\n      query: () => '/notifications/my-tokens',\n      transformResponse: (response: any) => response.data,\n      providesTags: ['PushToken'],\n    }),\n\n    // ============================================\n    // ADMIN ANNOUNCEMENT ENDPOINTS\n    // ============================================\n\n    // Send system announcement to all users (Admin only)\n    sendAnnouncement: builder.mutation<{\n      success: boolean;\n      message: string;\n      data: {\n        sentCount: number;\n        failedCount: number;\n      };\n    }, {\n      title: string;\n      message: string;\n      priority?: 'EMERGENCY' | 'HIGH' | 'MEDIUM' | 'LOW';\n    }>({\n      query: (data) => ({\n        url: '/notifications/admin/announce',\n        method: 'POST',\n        body: data,\n      }),\n      invalidatesTags: ['Notification', 'Announcement'],\n    }),\n\n    // Get announcements (filtered by SYSTEM_ANNOUNCEMENT type)\n    getAnnouncements: builder.query<{\n      notifications: Notification[];\n      pagination: {\n        page: number;\n        limit: number;\n        total: number;\n        totalPages: number;\n      };\n    }, {\n      page?: number;\n      limit?: number;\n    }>({\n      query: (params = {}) => ({\n        url: '/notifications',\n        params: {\n          ...params,\n          type: 'SYSTEM_ANNOUNCEMENT',\n        },\n      }),\n      transformResponse: (response: any) => response.data,\n      providesTags: ['Announcement'],\n    }),\n\n    // Get notification analytics (Admin)\n    getNotificationAnalytics: builder.query<{\n      totalNotifications: number;\n      byType: Record<string, number>;\n      byStatus: Record<string, number>;\n      byPriority: Record<string, number>;\n    }, {\n      fromDate?: string;\n      toDate?: string;\n    }>({\n      query: (params = {}) => ({\n        url: '/notifications/admin/analytics',\n        params,\n      }),\n      transformResponse: (response: any) => response.data,\n    }),\n  }),\n  overrideExisting: false,\n});\n\n// Export hooks for use in components\nexport const {\n  useGetNotificationsQuery,\n  useGetUnreadCountQuery,\n  useMarkAsReadMutation,\n  useMarkAllAsReadMutation,\n  useDeleteNotificationMutation,\n  useClearAllNotificationsMutation,\n  useGetNotificationPreferencesQuery,\n  useUpdateNotificationPreferencesMutation,\n  useRegisterPushTokenMutation,\n  useGetPushTokensQuery,\n  // Announcement hooks\n  useSendAnnouncementMutation,\n  useGetAnnouncementsQuery,\n  useGetNotificationAnalyticsQuery,\n} = notificationApi;\n\nexport default notificationApi;"],"names":["notificationApi","apiSlice","builder","params","response","notificationId","preferences","data","useGetNotificationsQuery","useGetUnreadCountQuery","useMarkAsReadMutation","useMarkAllAsReadMutation","useDeleteNotificationMutation","useClearAllNotificationsMutation"],"mappings":"wCA2BO,MAAMA,EAAkBC,EAAS,gBAAgB,CACtD,UAAYC,IAAa,CAEvB,iBAAkBA,EAAQ,MAavB,CACD,MAAO,CAACC,EAAS,MAAQ,CACvB,IAAK,iBACL,OAAAA,CAAA,GAEF,kBAAoBC,GAAkBA,EAAS,KAC/C,aAAc,CAAC,cAAc,CAAA,CAC9B,EAGD,eAAgBF,EAAQ,MAEf,CACP,MAAO,IAAM,8BACb,kBAAoBE,GAAkBA,EAAS,KAC/C,aAAc,CAAC,eAAgB,aAAa,CAAA,CAC7C,EAGD,WAAYF,EAAQ,SAGT,CACT,MAAQG,IAAoB,CAC1B,IAAK,kBAAkBA,CAAc,QACrC,OAAQ,KAAA,GAEV,gBAAiB,CAAC,eAAgB,aAAa,CAAA,CAChD,EAGD,cAAeH,EAAQ,SAGd,CACP,MAAO,KAAO,CACZ,IAAK,+BACL,OAAQ,KAAA,GAEV,gBAAiB,CAAC,eAAgB,aAAa,CAAA,CAChD,EAGD,mBAAoBA,EAAQ,SAGjB,CACT,MAAQG,IAAoB,CAC1B,IAAK,kBAAkBA,CAAc,GACrC,OAAQ,QAAA,GAEV,gBAAiB,CAAC,eAAgB,aAAa,CAAA,CAChD,EAGD,sBAAuBH,EAAQ,SAItB,CACP,MAAO,KAAO,CACZ,IAAK,2BACL,OAAQ,QAAA,GAEV,gBAAiB,CAAC,eAAgB,aAAa,CAAA,CAChD,EAGD,2BAA4BA,EAAQ,MAAqC,CACvE,MAAO,IAAM,6BACb,kBAAoBE,GAAkBA,EAAS,KAC/C,aAAc,CAAC,yBAAyB,CAAA,CACzC,EAGD,8BAA+BF,EAAQ,SAGF,CACnC,MAAQI,IAAiB,CACvB,IAAK,6BACL,OAAQ,MACR,KAAMA,CAAA,GAER,gBAAiB,CAAC,yBAAyB,CAAA,CAC5C,EAGD,kBAAmBJ,EAAQ,SAOxB,CACD,MAAQK,IAAU,CAChB,IAAK,gCACL,OAAQ,OACR,KAAMA,CAAA,EACR,CACD,EAGD,cAAeL,EAAQ,MAUd,CACP,MAAO,IAAM,2BACb,kBAAoBE,GAAkBA,EAAS,KAC/C,aAAc,CAAC,WAAW,CAAA,CAC3B,EAOD,iBAAkBF,EAAQ,SAWvB,CACD,MAAQK,IAAU,CAChB,IAAK,gCACL,OAAQ,OACR,KAAMA,CAAA,GAER,gBAAiB,CAAC,eAAgB,cAAc,CAAA,CACjD,EAGD,iBAAkBL,EAAQ,MAWvB,CACD,MAAO,CAACC,EAAS,MAAQ,CACvB,IAAK,iBACL,OAAQ,CACN,GAAGA,EACH,KAAM,qBAAA,CACR,GAEF,kBAAoBC,GAAkBA,EAAS,KAC/C,aAAc,CAAC,cAAc,CAAA,CAC9B,EAGD,yBAA0BF,EAAQ,MAQ/B,CACD,MAAO,CAACC,EAAS,MAAQ,CACvB,IAAK,iCACL,OAAAA,CAAA,GAEF,kBAAoBC,GAAkBA,EAAS,IAAA,CAChD,CAAA,GAEH,iBAAkB,EACpB,CAAC,EAGY,CACX,yBAAAI,EACA,uBAAAC,EACA,sBAAAC,EACA,yBAAAC,EACA,8BAAAC,EACA,iCAAAC,CASF,EAAIb"}