import{j as e}from"./ui-BlmhFX_F.js";import{r as n,b as ue,u as xe,L as U}from"./router-DFnE1L-t.js";import{u as be,s as he,i as pe,j as fe,k as ye,l as ve,m as je,z as o,n as we,o as ke,p as Ne}from"./index-DHymdRDT.js";import{D as Se,C as ze}from"./redux-VN59sPcb.js";import{T as Ce}from"./ThemeToggle-DELYC9XS.js";import{F as V}from"./ArrowLeftIcon-qMHYicG6.js";import{F as Oe}from"./ArrowPathIcon-2g4qvb1M.js";import{F as Ee}from"./EnvelopeIcon-BhdVQxlI.js";import{F as W}from"./CheckIcon-BVDXZInn.js";import{F as $}from"./BuildingOfficeIcon-2E4mAkhi.js";import{F as Re}from"./EyeSlashIcon-DScm6DLE.js";import{F as Ie}from"./EyeIcon-Bt_hkgUK.js";import"./vendor-gH-7aFTg.js";const D=s=>s.logoProxyUrl?`${ke().replace(/\/api$/,"")}${s.logoProxyUrl}`:s.logoUrl||null,We=()=>{const[s,v]=n.useState(""),[j,w]=n.useState(""),[P,Q]=n.useState(!1),[l,i]=n.useState("email"),[k,x]=n.useState([]),[d,g]=n.useState(null),[b,h]=n.useState(!1),[N,B]=n.useState(!1),[p,Y]=n.useState(""),[S,A]=n.useState(!1),[z,H]=n.useState(!1),{login:J,isLoading:f,error:C}=be(),c=ue(),y=xe(),K=Se(),X=ze(he),[Z,O]=n.useState(!1),[E,R]=n.useState(""),[I,F]=n.useState(""),[q,L]=n.useState(!1),[_]=pe(),[ee]=fe(),[te]=ye(),[ae,{isLoading:T}]=ve(),[re,{isLoading:G}]=je();n.useEffect(()=>{c.state?.emailVerified&&(o.success(c.state.message||"Email verified successfully! You can now sign in."),c.state.email&&v(c.state.email))},[c.state]);const se=async t=>{if(t.preventDefault(),!s.trim()){o.error("Please enter your email address");return}B(!0);try{const a=await _({email:s.trim().toLowerCase()}).unwrap();if(a.success&&a.data.organizations.length>0)x(a.data.organizations),h(!1),a.data.organizations.length===1?(g(a.data.organizations[0]),i("password")):i("organization");else{const r=await ee().unwrap();r.success&&r.data.organizations.length>0?(x(r.data.organizations),h(!0),i("organization")):o.error("No organizations available. Please contact support.")}}catch(a){console.error("Error checking email:",a),o.error("Failed to check email. Please try again.")}finally{B(!1)}},ne=t=>{g(t),localStorage.setItem("guild-org-code",t.tenantCode),b?y("/auth/register",{state:{email:s,organizationId:t.id,organizationName:t.name,tenantCode:t.tenantCode}}):i("password")},le=async t=>{if(t.preventDefault(),!p.trim()){o.error("Please enter an organization code");return}const a=p.trim().toUpperCase();A(!0);try{const r=Ne(a);r&&(localStorage.setItem("guild-api-url",r.apiUrl),localStorage.setItem("guild-org-code",r.code),localStorage.setItem("guild-org-name",r.name));const m=await te(a).unwrap();if(m.success&&m.data.organization){const u=m.data.organization;localStorage.setItem("guild-org-code",u.tenantCode),g(u),b?y("/auth/register",{state:{email:s,organizationId:u.id,organizationName:u.name,tenantCode:u.tenantCode}}):i("password"),o.success(`Connected to ${u.name}`)}else o.error("Organization not found. Please check the code and try again.")}catch(r){console.error("Error checking org code:",r),o.error("Invalid organization code. Please check and try again.")}finally{A(!1)}},oe=async t=>{if(t.preventDefault(),!d){o.error("Please select an organization first"),i("organization");return}const a=await J({email:s.trim().toLowerCase(),password:j,rememberMe:P,organizationId:d.id});a&&a.success||a?.error?.includes("deactivated")&&(R(s),O(!0))},ie=()=>{l==="password"?(k.length===1?(i("email"),g(null),x([])):i("organization"),w("")):l==="organization"&&(i("email"),g(null),x([]),h(!1))},de=()=>{i("email"),g(null),x([]),w(""),h(!1),localStorage.removeItem("guild-org-code")},ce=async t=>{t.preventDefault();try{await ae({email:E}).unwrap(),L(!0),o.success("Reactivation code sent to your email!")}catch(a){const r=a;o.error(r.data?.message||"Failed to send reactivation code")}},ge=async t=>{t.preventDefault();try{const a=await re({email:E,otp:I,organizationId:d?.id}).unwrap();a.data?.tokens&&a.data?.user&&(K(we({user:a.data.user,token:a.data.tokens.accessToken,refreshToken:a.data.tokens.refreshToken})),o.success("Account reactivated! Welcome back!"),y("/user/dashboard"))}catch(a){const r=a;o.error(r.data?.message||"Invalid or expired OTP")}},M=()=>e.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg border-b border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx(U,{to:"/",className:"flex items-center h-10",children:e.jsx("img",{src:X?"/brand/guild-logo-white.png":"/brand/guild-logo.png",alt:"GUILD",className:"h-full w-auto object-contain"})}),e.jsx(Ce,{})]})})});if(Z)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 dark:from-gray-900 dark:via-blue-900/20 dark:to-purple-900/20",children:[e.jsx(M,{}),e.jsx("div",{className:"min-h-screen flex items-center justify-center pt-16 px-4",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("button",{onClick:()=>{O(!1),L(!1),F("")},className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mb-6 transition-colors group",children:[e.jsx(V,{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform"}),e.jsx("span",{children:"Back to Login"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-8 md:p-10",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-4 bg-green-100 dark:bg-green-900/30 rounded-full",children:e.jsx(Oe,{className:"w-10 h-10 text-green-600 dark:text-green-400"})})}),e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-green-600 to-blue-600",children:"Reactivate Account"})}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:q?"Enter the code sent to your email":"We'll send you a code to reactivate your account"})]}),q?e.jsxs("form",{onSubmit:ge,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Enter 6-Digit Code"}),e.jsx("input",{type:"text",value:I,onChange:t=>F(t.target.value.replace(/\D/g,"").slice(0,6)),className:"w-full px-4 py-4 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all text-center text-2xl tracking-widest font-mono",placeholder:"000000",maxLength:6,required:!0})]}),e.jsx("button",{type:"submit",disabled:G||I.length!==6,className:"w-full py-4 bg-gradient-to-r from-green-600 to-blue-600 text-white rounded-xl font-semibold text-lg hover:shadow-xl hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:G?"Verifying...":"Reactivate Account"}),e.jsx("button",{type:"button",onClick:()=>{L(!1),F("")},className:"w-full py-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:"Didn't receive code? Try again"})]}):e.jsxs("form",{onSubmit:ce,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:E,onChange:t=>R(t.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all",placeholder:"Enter your email",required:!0})]}),e.jsx("button",{type:"submit",disabled:T,className:"w-full py-4 bg-gradient-to-r from-green-600 to-blue-600 text-white rounded-xl font-semibold text-lg hover:shadow-xl hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:T?"Sending Code...":"Send Reactivation Code"})]})]})]})})]});const me=()=>e.jsxs("div",{className:"flex items-center justify-center mb-6 space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full transition-all ${l==="email"?"bg-blue-600 scale-125":"bg-blue-600"}`}),e.jsx("div",{className:`w-8 h-0.5 ${l!=="email"?"bg-blue-600":"bg-gray-300 dark:bg-gray-600"}`}),e.jsx("div",{className:`w-3 h-3 rounded-full transition-all ${l==="organization"?"bg-blue-600 scale-125":l==="password"?"bg-blue-600":"bg-gray-300 dark:bg-gray-600"}`}),e.jsx("div",{className:`w-8 h-0.5 ${l==="password"?"bg-blue-600":"bg-gray-300 dark:bg-gray-600"}`}),e.jsx("div",{className:`w-3 h-3 rounded-full transition-all ${l==="password"?"bg-blue-600 scale-125":"bg-gray-300 dark:bg-gray-600"}`})]});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 dark:from-gray-900 dark:via-blue-900/20 dark:to-purple-900/20",children:[e.jsx(M,{}),e.jsx("div",{className:"min-h-screen flex items-center justify-center pt-16 px-4",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("button",{onClick:l==="email"?()=>y("/"):ie,className:"flex items-center space-x-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mb-6 transition-colors group",children:[e.jsx(V,{className:"w-5 h-5 group-hover:-translate-x-1 transition-transform"}),e.jsx("span",{children:l==="email"?"Back to Home":"Back"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-8 md:p-10",children:[e.jsx(me,{}),l==="email"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-4 bg-blue-100 dark:bg-blue-900/30 rounded-full",children:e.jsx(Ee,{className:"w-10 h-10 text-blue-600 dark:text-blue-400"})})}),e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600",children:"Welcome to GUILD"})}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Enter your email to continue"})]}),c.state?.emailVerified&&e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-200 p-4 rounded-xl mb-6 border border-green-200 dark:border-green-800",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"w-5 h-5 mr-2"}),c.state.message||"Email verified successfully! You can now sign in."]})}),e.jsxs("form",{onSubmit:se,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:s,onChange:t=>v(t.target.value),className:"w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Enter your email",required:!0,disabled:N,autoFocus:!0})]}),e.jsx("button",{type:"submit",disabled:N||!s.trim(),className:"w-full py-4 bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 text-white rounded-xl font-semibold text-lg hover:shadow-xl hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:N?"Checking...":"Continue"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["New to GUILD?"," ",e.jsx(U,{to:"/auth/register",className:"font-semibold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 transition-all",children:"Create an Account"})]})})]}),l==="organization"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-4 bg-blue-100 dark:bg-blue-900/30 rounded-full",children:e.jsx($,{className:"w-10 h-10 text-blue-600 dark:text-blue-400"})})}),e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600",children:b?"Select Your Organization":"Select Organization"})}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:b?"Choose an organization to register with":"Select the organization you want to sign in to"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-2",children:s})]}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:k.map(t=>{const a=D(t);return e.jsxs("button",{onClick:()=>ne(t),className:`w-full flex items-center justify-between p-4 rounded-xl border-2 transition-all hover:border-blue-300 dark:hover:border-blue-600 hover:bg-gray-50 dark:hover:bg-gray-700/50 ${d?.id===t.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[a?e.jsx("img",{src:a,alt:t.name,className:"w-12 h-12 rounded-lg object-cover",onError:r=>{r.target.style.display="none";const m=r.target.nextElementSibling;m&&m.classList.remove("hidden")}}):null,e.jsx("div",{className:`w-12 h-12 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center ${a?"hidden":""}`,children:e.jsx($,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.tenantCode})]})]}),e.jsx(W,{className:`w-6 h-6 ${d?.id===t.id?"text-blue-500":"text-transparent"}`})]},t.id)})}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3 text-center",children:"Or enter organization code directly"}),e.jsxs("form",{onSubmit:le,className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:p,onChange:t=>Y(t.target.value.toUpperCase()),className:"flex-1 px-4 py-2.5 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all text-sm uppercase",placeholder:"Enter organization code",disabled:S}),e.jsx("button",{type:"submit",disabled:S||!p.trim(),className:"px-4 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-medium text-sm hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:S?"...":"Go"})]})]}),b&&e.jsxs("p",{className:"mt-4 text-center text-sm text-gray-500 dark:text-gray-400",children:["Don't see your organization?"," ",e.jsx("a",{href:"mailto:support@guild.com",className:"text-blue-600 hover:underline",children:"Contact support"})]}),e.jsx("button",{onClick:de,className:"mt-4 w-full py-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors text-sm",children:"Use a different email"})]}),l==="password"&&d&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"flex justify-center mb-4",children:[(()=>{const t=D(d);return t?e.jsx("img",{src:t,alt:d.name,className:"w-16 h-16 rounded-xl object-cover shadow-lg",onError:a=>{a.target.style.display="none";const r=a.target.nextElementSibling;r&&r.classList.remove("hidden")}}):null})(),e.jsx("div",{className:`w-16 h-16 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg ${D(d)?"hidden":""}`,children:e.jsx($,{className:"w-8 h-8 text-white"})})]}),e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600",children:"Welcome Back"})}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:d.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:s})]}),C&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-200 p-4 rounded-xl mb-6 border border-red-200 dark:border-red-800",children:[e.jsx("div",{children:C}),C.includes("deactivated")&&e.jsx("button",{onClick:()=>{R(s),O(!0)},className:"mt-2 text-sm font-medium text-blue-600 dark:text-blue-400 hover:underline",children:"Reactivate your account"})]}),e.jsxs("form",{onSubmit:oe,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:z?"text":"password",value:j,onChange:t=>w(t.target.value),className:"w-full px-4 py-3 pr-12 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Enter your password",required:!0,disabled:f,autoFocus:!0}),e.jsx("button",{type:"button",onClick:()=>H(!z),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 focus:outline-none transition-colors",tabIndex:-1,children:z?e.jsx(Re,{className:"w-5 h-5"}):e.jsx(Ie,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:P,onChange:t=>Q(t.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",disabled:f}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"Remember me"})]}),e.jsx(U,{to:"/auth/forgot-password",state:{email:s,organizationId:d.id},className:"text-sm font-medium text-blue-600 hover:text-blue-500 transition-colors",children:"Forgot password?"})]}),e.jsx("button",{type:"submit",disabled:f,className:"w-full py-4 bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 text-white rounded-xl font-semibold text-lg hover:shadow-xl hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:f?"Signing in...":"Sign In"})]}),k.length>1&&e.jsx("button",{onClick:()=>i("organization"),className:"mt-4 w-full py-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors text-sm",children:"Sign in to a different organization"})]})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Powered by"," ",e.jsx("span",{className:"font-semibold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600",children:"Digikite"})]})})]})})]})};export{We as default};
//# sourceMappingURL=LoginPage-B56LFd-f.js.map
