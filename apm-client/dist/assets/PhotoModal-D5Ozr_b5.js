import{j as e,a as w,L as k}from"./ui-BlmhFX_F.js";import{r as a}from"./router-DFnE1L-t.js";import{c as y}from"./index-DLsoxDpQ.js";import{F as N}from"./PhotoIcon-n1eOvNeY.js";import{F as E}from"./UserCircleIcon-paQ8KrXl.js";import{F as $}from"./CalendarIcon-CroBm0p_.js";import{F as I}from"./CheckCircleIcon-DCBCeWMH.js";import{F as C}from"./XMarkIcon-D1c1wIzV.js";import{F as P}from"./ChevronLeftIcon-D6giPwF6.js";import{F as R}from"./ChevronRightIcon-CdFql2QB.js";import{F as z}from"./ArrowDownTrayIcon-DTq0PqpU.js";const K=({album:t,onClick:m,onAction:r,showActions:c=!1})=>{const[l,n]=a.useState(!1),[o,g]=a.useState(!1),[x,h]=a.useState(!1),[f,v]=a.useState(!1),u=a.useRef(null);a.useEffect(()=>{const d=new IntersectionObserver(F=>{F.forEach(L=>{L.isIntersecting&&(v(!0),d.disconnect())})},{rootMargin:"100px",threshold:.01});return u.current&&d.observe(u.current),()=>{d.disconnect()}},[]);const s=t._count?.photos||0,p=t.totalSize||0,j=p>0?`${(p/(1024*1024)).toFixed(2)} MB`:"0 MB",i=t.coverImage?y(`/api/albums/cover/${t.id}?t=${new Date(t.updatedAt).getTime()}`):null,b=t.creator?.id?y(`/api/users/profile-picture/${t.creator.id}`):null;return e.jsxs("div",{ref:u,className:"group relative bg-white dark:bg-gray-800 rounded-xl shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden cursor-pointer border border-gray-200 dark:border-gray-700",onClick:m,children:[e.jsxs("div",{className:"relative h-48 sm:h-56 bg-gradient-to-br from-guild-500/20 to-guild-600/20 dark:from-guild-400/10 dark:to-guild-500/10 overflow-hidden",children:[f?i?e.jsxs(e.Fragment,{children:[!o&&e.jsx("div",{className:"absolute inset-0 bg-gray-200 dark:bg-gray-700 animate-pulse",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-200 via-gray-100 to-gray-200 dark:from-gray-700 dark:via-gray-600 dark:to-gray-700 animate-shimmer"})}),e.jsx("img",{src:i,alt:t.name,className:`w-full h-full object-cover group-hover:scale-110 transition-all duration-500 ${o?"opacity-100":"opacity-0"}`,onLoad:()=>g(!0),onError:()=>g(!0)})]}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(N,{className:"w-20 h-20 text-gray-300 dark:text-gray-600"})}):e.jsx("div",{className:"w-full h-full bg-gray-200 dark:bg-gray-700 animate-pulse relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-200 via-gray-100 to-gray-200 dark:from-gray-700 dark:via-gray-600 dark:to-gray-700 animate-shimmer"})}),t.isArchived&&e.jsx("div",{className:"absolute top-3 right-3 bg-yellow-500 text-white px-3 py-1 rounded-full text-xs font-medium",children:"Archived"}),e.jsxs("div",{className:"absolute bottom-3 right-3 bg-black/60 backdrop-blur-sm text-white px-3 py-1 rounded-full text-sm font-medium flex items-center gap-1",children:[e.jsx(N,{className:"w-4 h-4"}),s]})]}),e.jsxs("div",{className:"p-4 sm:p-5",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white mb-2 truncate group-hover:text-guild-600 dark:group-hover:text-guild-400 transition-colors",children:t.name}),t.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[!l&&b&&f?e.jsxs(e.Fragment,{children:[!x&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 dark:bg-gray-700 animate-pulse"}),e.jsx("img",{src:b,alt:t.creator.fullName,className:`w-6 h-6 rounded-full object-cover border border-gray-200 dark:border-gray-600 ${x?"opacity-100":"opacity-0"}`,onLoad:()=>h(!0),onError:()=>{n(!0),h(!0)},style:{display:x?"block":"none"}})]}):e.jsx(E,{className:"w-6 h-6 text-gray-400"}),e.jsx("span",{className:"truncate max-w-[120px]",children:t.creator.fullName})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(t.createdAt).toLocaleDateString()})]})]}),p>0&&e.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:["Total size: ",j]}),c&&r&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700 flex gap-2",children:[e.jsx("button",{onClick:d=>{d.stopPropagation(),r("edit")},className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors",children:"Edit"}),e.jsx("button",{onClick:d=>{d.stopPropagation(),r("archive")},className:"flex-1 px-3 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg text-sm font-medium transition-colors",children:t.isArchived?"Unarchive":"Archive"}),e.jsx("button",{onClick:d=>{d.stopPropagation(),r("delete")},className:"flex-1 px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm font-medium transition-colors",children:"Delete"})]})]})]})},G=({photo:t,onClick:m,onAction:r,showActions:c=!1,selectionMode:l=!1,isSelected:n=!1,onToggleSelect:o})=>{const[g,x]=a.useState(!1),[h,f]=a.useState(!1),[v,u]=a.useState(!1),s=a.useRef(null);a.useEffect(()=>{const i=new IntersectionObserver(b=>{b.forEach(d=>{d.isIntersecting&&(u(!0),i.disconnect())})},{rootMargin:"100px",threshold:.01});return s.current&&i.observe(s.current),()=>{i.disconnect()}},[]);const j=(i=>{if(i.startsWith("http://")||i.startsWith("https://")){const b=i.split("/").pop();return y(`/api/albums/photo/${b}`)}return y(`/api/albums/photo/${i}`)})(t.url);return e.jsx("div",{ref:s,className:"group relative bg-gray-100 dark:bg-gray-700 rounded-lg shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden cursor-pointer border border-gray-200 dark:border-gray-700",onClick:l?o:m,children:e.jsxs("div",{className:"relative aspect-square bg-gray-100 dark:bg-gray-700 overflow-hidden",children:[v?e.jsxs(e.Fragment,{children:[!g&&!h&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-200 dark:bg-gray-700",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-guild-600"})}),h?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(S,{className:"w-12 h-12 mx-auto mb-2"}),e.jsx("p",{className:"text-xs",children:"Failed to load"})]})}):e.jsx("img",{src:j,alt:t.caption||"Photo",className:`w-full h-full object-cover group-hover:scale-105 transition-transform duration-500 ${g?"opacity-100":"opacity-0"}`,onLoad:()=>x(!0),onError:()=>f(!0)})]}):e.jsx("div",{className:"w-full h-full bg-gray-200 dark:bg-gray-700 animate-pulse relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-200 via-gray-100 to-gray-200 dark:from-gray-700 dark:via-gray-600 dark:to-gray-700 animate-shimmer"})}),l&&e.jsx("div",{className:"absolute top-2 left-2 z-10",onClick:i=>{i.stopPropagation(),o?.()},children:e.jsx("div",{className:`w-6 h-6 rounded-md border-2 flex items-center justify-center transition-all ${n?"bg-guild-600 border-guild-600":"bg-white/80 backdrop-blur-sm border-gray-300"}`,children:n&&e.jsx(I,{className:"w-5 h-5 text-white"})})}),t.caption&&!l&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 via-black/50 to-transparent p-3 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("p",{className:"text-white text-sm line-clamp-2",children:t.caption})}),c&&r&&!l&&e.jsx(e.Fragment,{children:e.jsx("button",{onClick:i=>{i.stopPropagation(),r("delete")},className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded-lg text-xs font-medium shadow-lg z-10",children:"Delete"})})]})})},S=({className:t})=>e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),J=({isOpen:t,onClose:m,photo:r,onPrevious:c,onNext:l,hasPrevious:n=!1,hasNext:o=!1})=>{const[g,x]=a.useState(!1),[h,f]=a.useState(!1);a.useEffect(()=>{if(r){x(!1),f(!0);const s=setTimeout(()=>f(!1),300);return()=>clearTimeout(s)}},[r?.id]);const v=s=>{if(s.startsWith("http://")||s.startsWith("https://")){const p=s.split("/").pop();return y(`/api/albums/photo/${p}`)}return y(`/api/albums/photo/${s}`)};if(a.useEffect(()=>{const s=p=>{if(t)switch(p.key){case"Escape":m();break;case"ArrowLeft":n&&c&&c();break;case"ArrowRight":o&&l&&l();break}};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[t,n,o,c,l,m]),!r)return null;const u=v(r.url);return e.jsx(w,{appear:!0,show:t,as:a.Fragment,children:e.jsxs(k,{as:"div",className:"relative z-50",onClose:m,children:[e.jsx(w.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/90 backdrop-blur-sm"})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsx(w.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(k.Panel,{className:"relative w-full max-w-7xl transform transition-all",children:[e.jsx("button",{onClick:m,className:"absolute -top-12 right-0 sm:top-0 sm:-right-12 p-2 text-white hover:text-gray-300 transition-colors z-10","aria-label":"Close",children:e.jsx(C,{className:"w-8 h-8"})}),n&&c&&e.jsx("button",{onClick:c,disabled:h,className:"absolute left-2 sm:-left-16 top-1/2 -translate-y-1/2 p-3 text-white hover:text-gray-300 transition-all bg-black/60 hover:bg-black/80 sm:bg-black/40 sm:hover:bg-black/60 rounded-full backdrop-blur-sm disabled:opacity-50 disabled:cursor-not-allowed group","aria-label":"Previous photo",children:e.jsx(P,{className:"w-6 h-6 sm:w-8 sm:h-8 group-hover:scale-110 transition-transform"})}),o&&l&&e.jsx("button",{onClick:l,disabled:h,className:"absolute right-2 sm:-right-16 top-1/2 -translate-y-1/2 p-3 text-white hover:text-gray-300 transition-all bg-black/60 hover:bg-black/80 sm:bg-black/40 sm:hover:bg-black/60 rounded-full backdrop-blur-sm disabled:opacity-50 disabled:cursor-not-allowed group","aria-label":"Next photo",children:e.jsx(R,{className:"w-6 h-6 sm:w-8 sm:h-8 group-hover:scale-110 transition-transform"})}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"relative bg-black rounded-lg overflow-hidden",children:[!g&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white"})}),e.jsx("img",{src:u,alt:r.caption||"Photo",className:`w-full max-h-[70vh] sm:max-h-[80vh] object-contain transition-opacity duration-300 ${g?"opacity-100":"opacity-0"}`,onLoad:()=>x(!0)}),e.jsx("div",{className:"absolute top-4 left-4 bg-black/70 backdrop-blur-sm text-white px-3 py-1.5 rounded-full text-sm font-medium",children:r.album?.name||"Photo"})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:r.caption&&e.jsx("p",{className:"text-lg text-gray-900 dark:text-white",children:r.caption})}),e.jsxs("div",{className:"flex items-center gap-4",children:[r.metadata?.sizeFormatted&&e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:r.metadata.sizeFormatted}),e.jsxs("a",{href:u,download:r.metadata?.originalName||"photo.jpg",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-guild-600 hover:bg-guild-700 text-white rounded-lg transition-colors text-sm font-medium whitespace-nowrap",children:[e.jsx(z,{className:"w-4 h-4"}),"Download"]})]})]})})]}),(n||o)&&e.jsxs("div",{className:"text-center mt-4 text-white/60 text-sm flex items-center justify-center gap-4",children:[e.jsx("span",{className:"hidden sm:inline",children:"Use arrow keys to navigate"}),e.jsx("span",{className:"hidden sm:inline",children:"•"}),e.jsx("span",{children:"ESC to close"}),(n||o)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{className:"flex items-center gap-2",children:[n&&e.jsx("span",{children:"← Prev"}),n&&o&&e.jsx("span",{children:"|"}),o&&e.jsx("span",{children:"Next →"})]})]})]})]})})})})]})})};export{K as A,G as P,J as a};
//# sourceMappingURL=PhotoModal-D5Ozr_b5.js.map
