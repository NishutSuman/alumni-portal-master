import{j as r}from"./ui-DXG44aSJ.js";import{r as n,L as A}from"./router-DFnE1L-t.js";import{k as F,z as h}from"./index-B-R1b6bD.js";import{L}from"./LoadingSpinner-B-lULuZT.js";import{F as q}from"./UserGroupIcon-CnvKPj6V.js";import{F as v}from"./UsersIcon-Ct2fUG5g.js";import{F as _}from"./CogIcon-DfBHaluj.js";import{F as N}from"./EyeIcon-Bt_hkgUK.js";import{F as D,a as P}from"./ChevronUpIcon-OweSaa88.js";import{F as V}from"./UserIcon-rexTD0xK.js";import{F as U}from"./TrashIcon-mpSEd7uz.js";function B({title:s,titleId:e,...a},t){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":e},a),s?n.createElement("title",{id:e},s):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z"}))}const J=n.forwardRef(B),z=F.injectEndpoints({endpoints:s=>({getPublicGroups:s.query({query:()=>"/groups/public",transformResponse:e=>e.data.groups,providesTags:["Group"]}),getGroups:s.query({query:e=>({url:"/groups",params:e}),transformResponse:e=>e.data,providesTags:["Group"]}),getGroup:s.query({query:({groupId:e,includeMembers:a=!0})=>({url:`/groups/${e}`,params:{includeMembers:a}}),transformResponse:e=>e.data,providesTags:(e,a,{groupId:t})=>[{type:"Group",id:t},"GroupMember"]}),getGroupMembers:s.query({query:({groupId:e,...a})=>({url:`/groups/${e}/members`,params:a}),transformResponse:e=>e.data,providesTags:(e,a,{groupId:t})=>[{type:"GroupMember",id:t}]}),getGroupStatistics:s.query({query:()=>"/groups/statistics",transformResponse:e=>e.data.statistics,providesTags:["GroupStats"]}),createGroup:s.mutation({query:e=>({url:"/groups",method:"POST",body:e}),transformResponse:e=>e.data.group,invalidatesTags:["Group","GroupStats"]}),updateGroup:s.mutation({query:({groupId:e,data:a})=>({url:`/groups/${e}`,method:"PUT",body:a}),transformResponse:e=>e.data.group,invalidatesTags:(e,a,{groupId:t})=>[{type:"Group",id:t},"Group","GroupStats"]}),deleteGroup:s.mutation({query:e=>({url:`/groups/${e}`,method:"DELETE"}),transformResponse:e=>e.data,invalidatesTags:["Group","GroupStats"]}),reorderGroups:s.mutation({query:e=>({url:"/groups/reorder",method:"POST",body:e}),transformResponse:e=>e.data,invalidatesTags:["Group"]}),addGroupMember:s.mutation({query:({groupId:e,data:a})=>({url:`/groups/${e}/members`,method:"POST",body:a}),transformResponse:e=>e.data.member,invalidatesTags:(e,a,{groupId:t})=>[{type:"Group",id:t},{type:"GroupMember",id:t},"GroupStats"]}),updateGroupMember:s.mutation({query:({groupId:e,userId:a,data:t})=>({url:`/groups/${e}/members/${a}`,method:"PUT",body:t}),transformResponse:e=>e.data.member,invalidatesTags:(e,a,{groupId:t})=>[{type:"Group",id:t},{type:"GroupMember",id:t},"GroupStats"]}),removeGroupMember:s.mutation({query:({groupId:e,userId:a})=>({url:`/groups/${e}/members/${a}`,method:"DELETE"}),transformResponse:e=>e.data,invalidatesTags:(e,a,{groupId:t})=>[{type:"Group",id:t},{type:"GroupMember",id:t},"GroupStats"]}),bulkMemberOperations:s.mutation({query:({groupId:e,data:a})=>({url:`/groups/${e}/members/bulk`,method:"POST",body:a}),transformResponse:e=>e.data,invalidatesTags:(e,a,{groupId:t})=>[{type:"Group",id:t},{type:"GroupMember",id:t},"GroupStats"]})}),overrideExisting:!1}),{useGetGroupsQuery:ne,useGetGroupQuery:H,useGetGroupStatisticsQuery:ce,useCreateGroupMutation:ue,useUpdateGroupMutation:me,useDeleteGroupMutation:pe,useAddGroupMemberMutation:xe,useRemoveGroupMemberMutation:Y}=z,K={CONVENER:{label:"Convener",colorClass:"bg-purple-100 text-purple-800 border-purple-200",priority:1},CO_CONVENER:{label:"Co-Convener",colorClass:"bg-purple-50 text-purple-700 border-purple-150",priority:2},STAKE_HOLDER:{label:"Stake Holder",colorClass:"bg-indigo-100 text-indigo-800 border-indigo-200",priority:3},PRESIDENT:{label:"President",colorClass:"bg-blue-100 text-blue-800 border-blue-200",priority:1},VICE_PRESIDENT:{label:"Vice President",colorClass:"bg-blue-50 text-blue-700 border-blue-150",priority:2},SECRETARY:{label:"Secretary",colorClass:"bg-green-100 text-green-800 border-green-200",priority:3},JOINT_SECRETARY:{label:"Joint Secretary",colorClass:"bg-green-50 text-green-700 border-green-150",priority:4},TREASURER:{label:"Treasurer",colorClass:"bg-orange-100 text-orange-800 border-orange-200",priority:5},JOINT_TREASURER:{label:"Joint Treasurer",colorClass:"bg-orange-50 text-orange-700 border-orange-150",priority:6},CHIEF_ADVISOR:{label:"Chief Advisor",colorClass:"bg-gray-100 text-gray-800 border-gray-200",priority:1},JOINT_ADVISOR:{label:"Joint Advisor",colorClass:"bg-gray-50 text-gray-700 border-gray-150",priority:2}},j={sm:"text-xs px-2 py-1 rounded-md",md:"text-sm px-3 py-1.5 rounded-lg",lg:"text-base px-4 py-2 rounded-lg"},C=s=>({CELL:["CONVENER","CO_CONVENER","STAKE_HOLDER"],COMMITTEE:["CONVENER","CO_CONVENER","STAKE_HOLDER"],OFFICE_BEARERS:["PRESIDENT","VICE_PRESIDENT","SECRETARY","JOINT_SECRETARY","TREASURER","JOINT_TREASURER"],ADVISORS:["CHIEF_ADVISOR","JOINT_ADVISOR"]})[s],Q=(s,e)=>C(e).includes(s),R=({role:s,groupType:e,size:a="md",className:t=""})=>{const i=K[s];if(!i)return r.jsx("span",{className:`inline-flex items-center font-medium bg-gray-100 text-gray-800 border border-gray-200 ${j[a]} ${t}`,children:s.replace(/_/g," ").toLowerCase().replace(/\b\w/g,u=>u.toUpperCase())});const d=!e||Q(s,e),x=d?i.colorClass:"bg-red-100 text-red-800 border-red-200";return r.jsxs("span",{className:`inline-flex items-center font-medium border ${x} ${j[a]} ${t}`,title:d?i.label:`Invalid role for ${e} group`,children:[i.label,!d&&r.jsx("span",{className:"ml-1 text-xs",children:"⚠️"})]})},Z={CELL:{label:"Cell",description:"Specialized working groups",colorClass:"bg-purple-100 text-purple-800 border-purple-200",iconColor:"text-purple-600"},COMMITTEE:{label:"Committee",description:"Advisory and decision-making bodies",colorClass:"bg-blue-100 text-blue-800 border-blue-200",iconColor:"text-blue-600"},OFFICE_BEARERS:{label:"Office Bearers",description:"Executive leadership team",colorClass:"bg-green-100 text-green-800 border-green-200",iconColor:"text-green-600"},ADVISORS:{label:"Advisors",description:"Advisory and guidance council",colorClass:"bg-orange-100 text-orange-800 border-orange-200",iconColor:"text-orange-600"}},ge=({group:s,showActions:e=!1,onEdit:a,onView:t,onAddMembers:i,showAccordion:d=!1,className:x="",isPublic:u=!1,showViewButton:E=!0})=>{const[m,k]=n.useState(!1),[g,b]=n.useState(null),c=Z[s.type],G=C(s.type),{data:T,isLoading:S,refetch:w}=H({groupId:s.id,includeMembers:!0},{skip:!m||!d}),[$]=Y(),y=T?.members||[],O=async(o,p)=>{if(confirm(`Are you sure you want to remove ${p} from ${s.name}?`)){b(o);try{console.log("Removing member with data:",{groupId:s.id,userId:o,groupIdLength:s.id.length,userIdLength:o.length,groupIdFormat:s.id,userIdFormat:o}),await $({groupId:s.id,userId:o}).unwrap(),h.success(`${p} removed from ${s.name}`),w()}catch(l){console.error("Remove member error:",l),console.error("Error details:",{status:l?.status,data:l?.data,message:l?.data?.message}),h.error(l?.data?.message||"Failed to remove member")}finally{b(null)}}},M=()=>{k(!m)},I=o=>{o.target.closest(".group-actions")||t&&t(s)};return r.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 border border-gray-200 dark:border-gray-700 ${t&&!e?"cursor-pointer hover:border-blue-300 dark:hover:border-blue-600":""} ${x}`,onClick:I,children:[r.jsxs("div",{className:"p-6 pb-4",children:[r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex items-start space-x-4",children:[r.jsx("div",{className:`p-3 rounded-lg ${c.colorClass.replace("text-","bg-").replace("-800","-100")} ${c.colorClass.replace("bg-","text-").replace("-100","-600")}`,children:r.jsx(q,{className:`w-6 h-6 ${c.iconColor}`})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:s.name}),r.jsx("div",{className:`w-2 h-2 rounded-full ${s.isActive?"bg-green-400":"bg-gray-400"}`,title:s.isActive?"Active":"Inactive"})]}),r.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium border ${c.colorClass}`,children:c.label})]})]}),r.jsxs("div",{className:"text-right flex-shrink-0 ml-4",children:[r.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400",children:[r.jsx(v,{className:"w-5 h-5 mr-2"}),r.jsx("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:s.membersCount})]}),r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:s.membersCount===1?"Member":"Members"})]})]}),s.description&&r.jsx("p",{className:"text-gray-600 dark:text-gray-300 mt-4 leading-relaxed",children:s.description})]}),r.jsx("div",{className:"px-6 pb-4",children:r.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Available Roles:"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:G.map(o=>r.jsx(R,{role:o,groupType:s.type,size:"sm"},o))})]})}),(e||!u)&&r.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 px-6 py-4 group-actions",children:r.jsxs("div",{className:"space-y-3",children:[e&&i&&r.jsxs("button",{onClick:()=>i(s),className:"w-full flex items-center justify-center px-4 py-2 text-sm font-medium text-blue-700 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/40 rounded-lg transition-colors border border-blue-200 dark:border-blue-700",children:[r.jsx(J,{className:"w-4 h-4 mr-2"}),"Add Members"]}),r.jsxs("div",{className:"flex space-x-3",children:[e&&a&&r.jsxs("button",{onClick:()=>a(s),className:"flex-1 flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:[r.jsx(_,{className:"w-4 h-4 mr-2"}),"Manage"]}),E&&t&&!e&&r.jsxs("button",{onClick:()=>t(s),className:"flex-1 flex items-center justify-center px-4 py-2 text-sm font-medium text-blue-700 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/40 rounded-lg transition-colors",children:[r.jsx(N,{className:"w-4 h-4 mr-2"}),"View Details"]}),u&&!t&&r.jsxs(A,{to:`/groups/${s.id}`,className:"flex-1 flex items-center justify-center px-4 py-2 text-sm font-medium text-blue-700 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/40 rounded-lg transition-colors",children:[r.jsx(N,{className:"w-4 h-4 mr-2"}),"Learn More"]})]})]})}),d&&e&&r.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700",children:[r.jsxs("button",{onClick:M,className:"w-full px-6 py-3 flex items-center justify-between text-left hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(v,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),r.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["Group Members (",s.membersCount,")"]})]}),m?r.jsx(D,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}):r.jsx(P,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})]}),m&&r.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700",children:S?r.jsx("div",{className:"p-6 flex justify-center",children:r.jsx(L,{size:"sm"})}):y.length===0?r.jsxs("div",{className:"p-6 text-center",children:[r.jsx(V,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),r.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"No members in this group yet"})]}):r.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:y.map(o=>r.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("div",{className:"flex-shrink-0",children:[o.user.profileImage?r.jsx("img",{src:`/api/users/profile-picture/${o.user.id}`,alt:o.user.fullName,className:"w-10 h-10 rounded-full object-cover",onError:p=>{const l=p.target;l.style.display="none";const f=l.parentElement?.querySelector(".fallback-avatar");f&&(f.style.display="flex")}}):null,r.jsx("div",{className:`fallback-avatar w-10 h-10 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center ${o.user.profileImage?"hidden":""}`,style:{display:o.user.profileImage?"none":"flex"},children:r.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:o.user.fullName.charAt(0).toUpperCase()})})]}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:o.user.fullName}),r.jsx(R,{role:o.role,groupType:s.type,size:"sm"})]}),r.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Batch ",o.user.batch," • ",o.user.email,!o.isActive&&r.jsx("span",{className:"ml-2 text-red-500",children:"• Inactive"})]})]})]}),r.jsx("button",{onClick:()=>O(o.user.id,o.user.fullName),disabled:g===o.user.id,className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:`Remove ${o.user.fullName} from group`,children:g===o.user.id?r.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):r.jsx(U,{className:"w-4 h-4"})})]},o.id))})})]}),!s.isActive&&r.jsx("div",{className:"absolute inset-0 bg-gray-500 bg-opacity-20 dark:bg-gray-900 dark:bg-opacity-40 rounded-lg flex items-center justify-center",children:r.jsx("div",{className:"bg-gray-800 dark:bg-gray-200 text-white dark:text-gray-800 px-4 py-2 rounded-full text-sm font-medium",children:"Inactive Group"})})]})};export{J as F,ge as G,ce as a,ue as b,xe as c,me as d,pe as e,C as g,ne as u};
//# sourceMappingURL=GroupListCard-D0EPgqu9.js.map
