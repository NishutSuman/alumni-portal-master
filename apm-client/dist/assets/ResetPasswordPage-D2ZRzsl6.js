import{j as e,m as l}from"./ui-BlmhFX_F.js";import{e as V,r as n,L as u}from"./router-DFnE1L-t.js";import{u as L}from"./index.esm-B0I9BSpA.js";import{o as q,c as z,d as b,e as T}from"./index.esm-kU_tS0bV.js";import{u as A,K as E,z as B}from"./index-DHymdRDT.js";import{F as I}from"./ExclamationTriangleIcon-DCwPn2ZM.js";import{F as W}from"./LockClosedIcon-DXv4ScAJ.js";import{F as y}from"./EyeSlashIcon-DScm6DLE.js";import{F as j}from"./EyeIcon-Bt_hkgUK.js";import{F as Y}from"./ArrowLeftIcon-qMHYicG6.js";import"./redux-VN59sPcb.js";import"./vendor-gH-7aFTg.js";const Z=z().shape({newPassword:b().required("New password is required").min(8,"Password must be at least 8 characters").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/,"Password must contain uppercase, lowercase, number, and special character"),confirmPassword:b().required("Please confirm your password").oneOf([T("newPassword")],"Passwords do not match")}),re=()=>{const[h]=V(),{resetPassword:N}=A(),[d,k]=n.useState(!1),[c,v]=n.useState(!1),[P,m]=n.useState(null),t=h.get("token"),g=h.get("email"),{data:x,error:w,isLoading:R}=E(t||"",{skip:!t});n.useEffect(()=>{if(!t){m(!1);return}x?m(x.valid):w&&m(!1)},[t,x,w]);const{register:f,handleSubmit:S,formState:{errors:r,isSubmitting:i},watch:$}=L({resolver:q(Z),mode:"onChange"}),p=$("newPassword"),F=s=>{if(!s)return{score:0,text:"",color:"bg-gray-200"};let a=0;return a=[s.length>=8,/[a-z]/.test(s),/[A-Z]/.test(s),/\d/.test(s),/[@$!%*?&]/.test(s)].filter(Boolean).length,{score:a,...{0:{text:"Very Weak",color:"bg-red-500"},1:{text:"Very Weak",color:"bg-red-500"},2:{text:"Weak",color:"bg-orange-500"},3:{text:"Fair",color:"bg-yellow-500"},4:{text:"Good",color:"bg-blue-500"},5:{text:"Strong",color:"bg-green-500"}}[a]}},C=async s=>{if(!t){B.error("Invalid reset token");return}try{(await N(t,s.newPassword,s.confirmPassword)).success}catch(a){console.error("Reset password error:",a)}},o=F(p||"");return R?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-900 dark:via-blue-900 dark:to-indigo-900 flex items-center justify-center",children:e.jsxs("div",{className:"glass-card p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Validating reset token..."})]})}):P===!1?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-900 dark:via-blue-900 dark:to-indigo-900 py-12 px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:[e.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-red-500 to-red-600 rounded-full flex items-center justify-center mb-4",children:e.jsx(I,{className:"h-8 w-8 text-white"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Invalid Reset Link"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-8",children:"This password reset link is invalid or has expired. Please request a new one."}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(u,{to:"/auth/forgot-password",className:"block w-full btn-guild",children:"Request New Reset Link"}),e.jsx(u,{to:"/auth/login",className:"block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Back to Login"})]})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-900 dark:via-blue-900 dark:to-indigo-900 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs(l.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:[e.jsx("div",{className:"mx-auto h-16 w-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mb-4",children:e.jsx(W,{className:"h-8 w-8 text-white"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Reset Your Password"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-300",children:g?`Resetting password for ${g}`:"Create a new secure password for your account"})]}),e.jsx(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-card p-8",children:e.jsxs("form",{onSubmit:S(C),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"New Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{...f("newPassword"),type:d?"text":"password",placeholder:"Create a strong password",className:`form-input pr-10 ${r.newPassword?"border-red-500":""}`,disabled:i}),e.jsx("button",{type:"button",onClick:()=>k(!d),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:d?e.jsx(y,{className:"h-5 w-5"}):e.jsx(j,{className:"h-5 w-5"})})]}),p&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Password strength"}),e.jsx("span",{className:`text-xs font-medium ${o.score>=4?"text-green-500":o.score>=3?"text-yellow-500":"text-red-500"}`,children:o.text})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${o.color}`,style:{width:`${o.score/5*100}%`}})})]}),r.newPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.newPassword.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirm New Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{...f("confirmPassword"),type:c?"text":"password",placeholder:"Confirm your password",className:`form-input pr-10 ${r.confirmPassword?"border-red-500":""}`,disabled:i}),e.jsx("button",{type:"button",onClick:()=>v(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?e.jsx(y,{className:"h-5 w-5"}):e.jsx(j,{className:"h-5 w-5"})})]}),r.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:r.confirmPassword.message})]}),e.jsx("button",{type:"submit",disabled:i,className:"w-full btn-guild disabled:opacity-50 disabled:cursor-not-allowed",children:i?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Resetting Password..."]}):"Reset Password"}),e.jsx("div",{className:"text-center",children:e.jsxs(u,{to:"/auth/login",className:"inline-flex items-center text-sm text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:[e.jsx(Y,{className:"h-4 w-4 mr-1"}),"Back to Login"]})})]})}),e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"mt-6 text-center",children:e.jsxs("div",{className:"glass-card p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Security Notice"}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[e.jsx("p",{children:"• Your new password must be strong and unique"}),e.jsx("p",{children:"• This reset link will expire after use"}),e.jsx("p",{children:"• You'll be automatically logged out from other devices"})]})]})})]})})};export{re as default};
//# sourceMappingURL=ResetPasswordPage-D2ZRzsl6.js.map
