import{j as e}from"./ui-BlmhFX_F.js";import{r as x}from"./router-DFnE1L-t.js";import{u as v,a as E,b as S,c as C,d as D}from"./developerApi-Byh796EX.js";import{L as M}from"./LoadingSpinner-BR8iBbEe.js";import{o as z}from"./index-P8gjH_om.js";import"./redux-VN59sPcb.js";import"./vendor-gH-7aFTg.js";const O=d=>d.logoUrl?`${z().replace(/\/api$/,"")}/api/organizations/${d.id}/files/logo`:null,b={TRIAL:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",ACTIVE:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",EXPIRED:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",SUSPENDED:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"};function P(){const[d,s]=x.useState(!1),[l,h]=x.useState(""),[c,p]=x.useState(""),{data:r,isLoading:y,error:n}=v(),{data:g,isLoading:j,error:o}=E({search:l||void 0,status:c||void 0,limit:50}),[f,{isLoading:m}]=S(),[N]=C(),[k]=D(),w=async a=>{a.preventDefault();const t=new FormData(a.currentTarget);try{await f({name:t.get("name"),shortName:t.get("shortName"),tenantCode:t.get("tenantCode"),officialEmail:t.get("officialEmail"),foundationYear:parseInt(t.get("foundationYear")),subscriptionDays:parseInt(t.get("subscriptionDays"))||30,maxUsers:parseInt(t.get("maxUsers"))||500}).unwrap(),s(!1)}catch(i){console.error("Failed to create organization:",i)}};return y||j?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(M,{})}):n||o?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen p-6",children:[e.jsx("div",{className:"text-red-500 text-lg mb-4",children:"Failed to load developer dashboard"}),e.jsxs("div",{className:"text-gray-500 text-sm mb-4 max-w-lg text-center",children:[n&&e.jsxs("div",{children:["Dashboard Error: ",JSON.stringify(n)]}),o&&e.jsxs("div",{children:["Orgs Error: ",JSON.stringify(o)]})]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Reload Page"})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Developer Portal"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Manage multi-tenant organizations and subscriptions"})]}),r&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.organizations.total}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Organizations"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.organizations.active}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Active Organizations"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:r.organizations.inMaintenance}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"In Maintenance"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:r.systemTotals.users}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Users"})]})]}),r?.subscriptions&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Subscription Status Breakdown"}),e.jsx("div",{className:"flex flex-wrap gap-4",children:Object.entries(r.subscriptions).map(([a,t])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${b[a]}`,children:a}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:t})]},a))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Organizations"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("input",{type:"text",placeholder:"Search organizations...",value:l,onChange:a=>h(a.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),e.jsxs("select",{value:c,onChange:a=>p(a.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"TRIAL",children:"Trial"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"EXPIRED",children:"Expired"}),e.jsx("option",{value:"SUSPENDED",children:"Suspended"})]}),e.jsx("button",{onClick:()=>s(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"+ New Organization"})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Organization"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Tenant Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Users"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Expires"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:Array.isArray(g?.data)&&g.data.map(a=>{const t=O(a);return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"h-10 w-10 flex-shrink-0",children:[t?e.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:t,alt:a.name,onError:i=>{i.target.style.display="none";const u=i.target.nextElementSibling;u&&(u.style.display="flex")}}):null,e.jsx("div",{className:`h-10 w-10 rounded-full bg-blue-100 dark:bg-blue-900 items-center justify-center ${t?"hidden":"flex"}`,children:e.jsx("span",{className:"text-blue-600 dark:text-blue-300 font-semibold",children:a.shortName.charAt(0)})})]}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white max-w-[200px] truncate",children:a.name}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.officialEmail})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("code",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded text-sm",children:a.tenantCode})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b[a.subscriptionStatus]}`,children:a.subscriptionStatus}),a.isMaintenanceMode&&e.jsx("span",{className:"ml-2 px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs",children:"Maintenance"})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[a._count?.users||0," / ",a.maxUsers]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:a.subscriptionEndsAt?new Date(a.subscriptionEndsAt).toLocaleDateString():"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>N({orgId:a.id,isMaintenanceMode:!a.isMaintenanceMode}),className:`px-3 py-1 rounded text-xs ${a.isMaintenanceMode?"bg-green-100 text-green-800 hover:bg-green-200":"bg-orange-100 text-orange-800 hover:bg-orange-200"}`,children:a.isMaintenanceMode?"Enable":"Maintenance"}),e.jsx("button",{onClick:()=>k({orgId:a.id,subscriptionDays:30,subscriptionStatus:"ACTIVE"}),className:"px-3 py-1 bg-blue-100 text-blue-800 rounded text-xs hover:bg-blue-200",children:"+30 Days"})]})})]},a.id)})})]})})]}),d&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black opacity-50",onClick:()=>s(!1)}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Create New Organization"}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Organization Name *"}),e.jsx("input",{type:"text",name:"name",required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Short Name *"}),e.jsx("input",{type:"text",name:"shortName",required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tenant Code * (e.g., SCHOOL-ABC)"}),e.jsx("input",{type:"text",name:"tenantCode",required:!0,pattern:"[A-Za-z0-9-]+",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white uppercase"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Official Email *"}),e.jsx("input",{type:"email",name:"officialEmail",required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Foundation Year *"}),e.jsx("input",{type:"number",name:"foundationYear",required:!0,min:1800,max:new Date().getFullYear(),defaultValue:new Date().getFullYear(),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Trial Days"}),e.jsx("input",{type:"number",name:"subscriptionDays",defaultValue:30,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Max Users"}),e.jsx("input",{type:"number",name:"maxUsers",defaultValue:500,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:m?"Creating...":"Create Organization"})]})]})]})]})})]})})}export{P as default};
//# sourceMappingURL=DeveloperDashboard-CCWI0JSb.js.map
