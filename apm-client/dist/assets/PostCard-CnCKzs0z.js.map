{"version":3,"file":"PostCard-CnCKzs0z.js","sources":["../../node_modules/@heroicons/react/24/outline/esm/ChatBubbleLeftIcon.js","../../node_modules/@heroicons/react/24/outline/esm/EllipsisHorizontalIcon.js","../../node_modules/@heroicons/react/24/outline/esm/ShareIcon.js","../../src/components/common/UI/ReactionsModal.tsx","../../src/components/common/UI/LinkedInReactions.tsx","../../src/components/common/UI/CommentReactionsModal.tsx","../../src/components/common/UI/CommentsSection.tsx","../../src/components/user/PostCard.tsx"],"sourcesContent":["import * as React from \"react\";\nfunction ChatBubbleLeftIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.282 48.282 0 0 0 5.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(ChatBubbleLeftIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction EllipsisHorizontalIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(EllipsisHorizontalIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction ShareIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(ShareIcon);\nexport default ForwardRef;","import React, { useState } from 'react';\nimport { Dialog, Transition } from '@headlessui/react';\nimport { Fragment } from 'react';\nimport { XMarkIcon } from '@heroicons/react/24/outline';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { useGetPostReactionUsersQuery } from '../../../store/api/postApi';\nimport type { ReactionType } from '../../../types/post';\nimport { Link } from 'react-router-dom';\nimport { formatDistanceToNow } from 'date-fns';\n\ninterface ReactionsModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  postId: string;\n}\n\nconst REACTION_CONFIG: Record<ReactionType, { emoji: string; label: string; color: string }> = {\n  LIKE: { emoji: 'üëç', label: 'Like', color: 'text-blue-600 dark:text-blue-400' },\n  LOVE: { emoji: '‚ù§Ô∏è', label: 'Love', color: 'text-red-600 dark:text-red-400' },\n  CELEBRATE: { emoji: 'üéâ', label: 'Celebrate', color: 'text-yellow-600 dark:text-yellow-400' },\n  SUPPORT: { emoji: 'üôå', label: 'Support', color: 'text-green-600 dark:text-green-400' },\n  FUNNY: { emoji: 'üòÇ', label: 'Funny', color: 'text-orange-600 dark:text-orange-400' },\n  WOW: { emoji: 'üòÆ', label: 'Wow', color: 'text-purple-600 dark:text-purple-400' },\n  ANGRY: { emoji: 'üò†', label: 'Angry', color: 'text-red-700 dark:text-red-300' },\n  SAD: { emoji: 'üò¢', label: 'Sad', color: 'text-blue-700 dark:text-blue-300' },\n};\n\nconst ReactionsModal: React.FC<ReactionsModalProps> = ({\n  isOpen,\n  onClose,\n  postId,\n}) => {\n  const [selectedTab, setSelectedTab] = useState<string>('ALL');\n  const [page, setPage] = useState(1);\n\n  const {\n    data: reactionsData,\n    isLoading,\n    error,\n  } = useGetPostReactionUsersQuery(\n    { \n      postId, \n      reactionType: selectedTab === 'ALL' ? undefined : selectedTab,\n      page,\n      limit: 20 \n    },\n    { skip: !isOpen }\n  );\n\n  const getInitials = (name: string) => {\n    return name\n      .split(' ')\n      .map(word => word.charAt(0))\n      .join('')\n      .slice(0, 2)\n      .toUpperCase();\n  };\n\n  // Get available reaction types with counts\n  const availableReactions = reactionsData?.reactionCounts \n    ? Object.entries(reactionsData.reactionCounts)\n        .filter(([_, count]) => count > 0)\n        .sort(([a, countA], [b, countB]) => {\n          if (a === 'ALL') return -1;\n          if (b === 'ALL') return 1;\n          return countB - countA; // Sort by count descending\n        })\n    : [];\n\n  return (\n    <Transition appear show={isOpen} as={Fragment}>\n      <Dialog as=\"div\" className=\"relative z-50\" onClose={onClose}>\n        <Transition.Child\n          as={Fragment}\n          enter=\"ease-out duration-300\"\n          enterFrom=\"opacity-0\"\n          enterTo=\"opacity-100\"\n          leave=\"ease-in duration-200\"\n          leaveFrom=\"opacity-100\"\n          leaveTo=\"opacity-0\"\n        >\n          <div className=\"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm\" />\n        </Transition.Child>\n\n        <div className=\"fixed inset-0 overflow-y-auto\">\n          <div className=\"flex min-h-full items-center justify-center p-4 text-center\">\n            <Transition.Child\n              as={Fragment}\n              enter=\"ease-out duration-300\"\n              enterFrom=\"opacity-0 scale-95\"\n              enterTo=\"opacity-100 scale-100\"\n              leave=\"ease-in duration-200\"\n              leaveFrom=\"opacity-100 scale-100\"\n              leaveTo=\"opacity-0 scale-95\"\n            >\n              <Dialog.Panel className=\"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-6 text-left align-middle shadow-xl transition-all\">\n                {/* Header */}\n                <div className=\"flex items-center justify-between mb-4\">\n                  <Dialog.Title\n                    as=\"h3\"\n                    className=\"text-lg font-medium leading-6 text-gray-900 dark:text-white\"\n                  >\n                    Reactions\n                  </Dialog.Title>\n                  <button\n                    onClick={onClose}\n                    className=\"rounded-md p-2 text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                {/* Reaction Tabs */}\n                {availableReactions.length > 0 && (\n                  <div className=\"flex space-x-1 mb-4 overflow-x-auto\">\n                    {availableReactions.map(([reactionType, count]) => (\n                      <button\n                        key={reactionType}\n                        onClick={() => {\n                          setSelectedTab(reactionType);\n                          setPage(1);\n                        }}\n                        className={`flex items-center space-x-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${\n                          selectedTab === reactionType\n                            ? 'bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300'\n                            : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700'\n                        }`}\n                      >\n                        {reactionType !== 'ALL' && (\n                          <span className=\"text-base\">\n                            {REACTION_CONFIG[reactionType as ReactionType]?.emoji}\n                          </span>\n                        )}\n                        {reactionType === 'ALL' && <span>All</span>}\n                        <span className=\"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 px-2 py-0.5 rounded-full text-xs\">\n                          {count}\n                        </span>\n                      </button>\n                    ))}\n                  </div>\n                )}\n\n                {/* Reactions List */}\n                <div className=\"h-96 overflow-y-auto\">\n                  {isLoading ? (\n                    <div className=\"flex justify-center py-8\">\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n                    </div>\n                  ) : error ? (\n                    <div className=\"text-center py-8 text-red-600 dark:text-red-400\">\n                      Failed to load reactions\n                    </div>\n                  ) : reactionsData?.reactions?.length === 0 ? (\n                    <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                      No reactions found\n                    </div>\n                  ) : (\n                    <div className=\"space-y-3\">\n                      <AnimatePresence mode=\"popLayout\">\n                        {reactionsData?.reactions?.map((reaction, index) => (\n                          <motion.div\n                            key={reaction.id}\n                            initial={{ opacity: 0, y: 20 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            exit={{ opacity: 0, y: -20 }}\n                            transition={{ duration: 0.2, delay: index * 0.05 }}\n                            className=\"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700\"\n                          >\n                            {/* Profile Picture */}\n                            <div className=\"relative\">\n                              {reaction.user.profileImage ? (\n                                <img\n                                  src={`/api/users/profile-picture/${reaction.user.id}`}\n                                  alt={reaction.user.fullName}\n                                  className=\"h-10 w-10 rounded-full object-cover\"\n                                />\n                              ) : (\n                                <div className=\"h-10 w-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-sm\">\n                                  {getInitials(reaction.user.fullName)}\n                                </div>\n                              )}\n                              \n                              {/* Reaction Emoji Badge */}\n                              <div className=\"absolute -bottom-0.5 -right-0.5 bg-white dark:bg-gray-800 rounded-full p-0.5 border border-gray-200 dark:border-gray-600 w-5 h-5 flex items-center justify-center\">\n                                <span className=\"text-xs\">\n                                  {REACTION_CONFIG[reaction.reactionType]?.emoji}\n                                </span>\n                              </div>\n                            </div>\n\n                            {/* User Info */}\n                            <div className=\"flex-1 min-w-0\">\n                              <Link\n                                to={`/alumni/${reaction.user.id}`}\n                                className=\"block hover:text-blue-600 dark:hover:text-blue-400\"\n                              >\n                                <p className=\"text-sm font-medium text-gray-900 dark:text-white truncate\">\n                                  {reaction.user.fullName}\n                                </p>\n                                <p className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">\n                                  {reaction.user.currentPosition && reaction.user.currentCompany\n                                    ? `${reaction.user.currentPosition} at ${reaction.user.currentCompany}`\n                                    : reaction.user.currentPosition || reaction.user.currentCompany || \n                                      (reaction.user.batch && `Batch ${reaction.user.batch}`) || 'Alumni'\n                                  }\n                                </p>\n                              </Link>\n                              <p className=\"text-xs text-gray-400 dark:text-gray-500\">\n                                {formatDistanceToNow(new Date(reaction.createdAt), { addSuffix: true })}\n                              </p>\n                            </div>\n                          </motion.div>\n                        ))}\n                      </AnimatePresence>\n                    </div>\n                  )}\n                </div>\n\n                {/* Pagination */}\n                {reactionsData?.pagination && reactionsData.pagination.pages > 1 && (\n                  <div className=\"flex justify-between items-center mt-4 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                    <button\n                      onClick={() => setPage(p => Math.max(1, p - 1))}\n                      disabled={!reactionsData.pagination.hasPrev}\n                      className=\"px-3 py-1 text-sm rounded-md bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      Previous\n                    </button>\n                    \n                    <span className=\"text-sm text-gray-500 dark:text-gray-400\">\n                      Page {reactionsData.pagination.page} of {reactionsData.pagination.pages}\n                    </span>\n                    \n                    <button\n                      onClick={() => setPage(p => p + 1)}\n                      disabled={!reactionsData.pagination.hasNext}\n                      className=\"px-3 py-1 text-sm rounded-md bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      Next\n                    </button>\n                  </div>\n                )}\n              </Dialog.Panel>\n            </Transition.Child>\n          </div>\n        </div>\n      </Dialog>\n    </Transition>\n  );\n};\n\nexport default ReactionsModal;","import React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { ChatBubbleLeftIcon, ShareIcon } from '@heroicons/react/24/outline';\nimport type { ReactionType } from '../../../types/post';\nimport ReactionsModal from './ReactionsModal';\n\ninterface LinkedInReactionsProps {\n  postId: string;\n  reactions: Record<ReactionType, number>;\n  userReactions: ReactionType[];\n  totalReactions: number;\n  recentReactions?: Array<{\n    reactionType: ReactionType;\n    userId: string;\n    user: {\n      id: string;\n      fullName: string;\n      profileImage?: string;\n    };\n  }>;\n  onReact: (reactionType: ReactionType) => void;\n  onCommentClick?: () => void;\n  onShareClick?: () => void;\n  commentCount?: number;\n  disabled?: boolean;\n  className?: string;\n}\n\nconst REACTION_CONFIG: Record<ReactionType, { emoji: string; label: string; color: string }> = {\n  LIKE: { emoji: 'üëç', label: 'Like', color: 'text-blue-600 dark:text-blue-400' },\n  LOVE: { emoji: '‚ù§Ô∏è', label: 'Love', color: 'text-red-600 dark:text-red-400' },\n  CELEBRATE: { emoji: 'üéâ', label: 'Celebrate', color: 'text-yellow-600 dark:text-yellow-400' },\n  SUPPORT: { emoji: 'üôå', label: 'Support', color: 'text-green-600 dark:text-green-400' },\n  FUNNY: { emoji: 'üòÇ', label: 'Funny', color: 'text-orange-600 dark:text-orange-400' },\n  WOW: { emoji: 'üòÆ', label: 'Wow', color: 'text-purple-600 dark:text-purple-400' },\n  ANGRY: { emoji: 'üò†', label: 'Angry', color: 'text-red-700 dark:text-red-300' },\n  SAD: { emoji: 'üò¢', label: 'Sad', color: 'text-blue-700 dark:text-blue-300' },\n};\n\nconst LinkedInReactions: React.FC<LinkedInReactionsProps> = ({\n  postId,\n  reactions,\n  userReactions,\n  totalReactions,\n  recentReactions = [],\n  onReact,\n  onCommentClick,\n  onShareClick,\n  commentCount = 0,\n  disabled = false,\n  className = '',\n}) => {\n  const [showPicker, setShowPicker] = useState(false);\n  const [isHovering, setIsHovering] = useState(false);\n  const [showReactionsModal, setShowReactionsModal] = useState(false);\n\n  // Get user's current reaction (only one allowed)\n  const userReaction = userReactions?.[0];\n  const hasReacted = !!userReaction;\n\n  // Get top reactions for display (max 3)\n  const topReactions = Object.entries(reactions || {})\n    .filter(([_, count]) => count > 0)\n    .sort(([, a], [, b]) => b - a)\n    .slice(0, 3)\n    .map(([type]) => type as ReactionType);\n\n  const handleReactionClick = (reactionType: ReactionType) => {\n    onReact(reactionType);\n    setShowPicker(false);\n  };\n\n  const handleMainButtonClick = () => {\n    if (hasReacted) {\n      // Remove current reaction\n      onReact(userReaction);\n    } else {\n      // Add LIKE reaction\n      onReact('LIKE');\n    }\n  };\n\n  // Show picker on hover with delay\n  useEffect(() => {\n    let timeout: NodeJS.Timeout;\n    if (isHovering && !disabled) {\n      timeout = setTimeout(() => {\n        setShowPicker(true);\n      }, 500);\n    }\n    return () => {\n      if (timeout) clearTimeout(timeout);\n    };\n  }, [isHovering, disabled]);\n\n  // Generate LinkedIn-style reaction text\n  const getReactionText = () => {\n    if (totalReactions === 0 || !totalReactions) return null;\n    \n    const uniqueUsers = Array.from(\n      new Map(recentReactions.map(r => [r.userId, r])).values()\n    );\n    \n    if (uniqueUsers.length === 0) {\n      return `${totalReactions}`;\n    }\n    \n    if (uniqueUsers.length === 1) {\n      if (totalReactions === 1) {\n        return uniqueUsers[0].user.fullName;\n      } else {\n        return `${uniqueUsers[0].user.fullName} and ${totalReactions - 1} others`;\n      }\n    } else if (uniqueUsers.length === 2) {\n      if (totalReactions === 2) {\n        return `${uniqueUsers[0].user.fullName} and ${uniqueUsers[1].user.fullName}`;\n      } else {\n        return `${uniqueUsers[0].user.fullName}, ${uniqueUsers[1].user.fullName} and ${totalReactions - 2} others`;\n      }\n    } else {\n      return `${uniqueUsers[0].user.fullName}, ${uniqueUsers[1].user.fullName} and ${totalReactions - 2} others`;\n    }\n  };\n\n  return (\n    <div className={`space-y-3 ${className}`}>\n      {/* Top section: Reaction summary (LinkedIn style) */}\n      {totalReactions > 0 && (\n        <div className=\"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400\">\n          <button \n            onClick={() => setShowReactionsModal(true)}\n            className=\"flex items-center space-x-2 hover:text-gray-700 dark:hover:text-gray-300 hover:underline cursor-pointer\"\n          >\n            {/* Reaction emojis stack */}\n            <div className=\"flex -space-x-1\">\n              {topReactions.map((reactionType, index) => (\n                <div\n                  key={reactionType}\n                  className=\"w-5 h-5 rounded-full bg-blue-600 text-white flex items-center justify-center text-xs border-2 border-white dark:border-gray-800\"\n                  style={{ zIndex: topReactions.length - index }}\n                >\n                  {REACTION_CONFIG[reactionType].emoji}\n                </div>\n              ))}\n            </div>\n            \n            {/* LinkedIn-style reaction text */}\n            <span className=\"ml-1\">\n              {getReactionText()}\n            </span>\n          </button>\n\n          {/* Comments count */}\n          {commentCount > 0 && (\n            <button \n              onClick={onCommentClick}\n              className=\"hover:text-gray-700 dark:hover:text-gray-300 hover:underline\"\n            >\n              {commentCount === 1 ? '1 comment' : `${commentCount} comments`}\n            </button>\n          )}\n        </div>\n      )}\n\n      {/* Bottom section: Action buttons (LinkedIn style) */}\n      <div className=\"flex items-center justify-between border-t border-gray-100 dark:border-gray-700 pt-2\">\n        <div className=\"flex items-center space-x-1\">\n          {/* Like/Reaction button */}\n          <div className=\"relative\">\n            <button\n              onClick={handleMainButtonClick}\n              onMouseEnter={() => setIsHovering(true)}\n              onMouseLeave={() => setIsHovering(false)}\n              disabled={disabled}\n              className={`flex items-center space-x-2 px-4 py-2 rounded-md transition-all duration-200 ${\n                hasReacted\n                  ? `${REACTION_CONFIG[userReaction]?.color} bg-blue-50 dark:bg-blue-900/20 font-medium`\n                  : 'text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-700'\n              } ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}`}\n            >\n              <span className=\"text-lg\">\n                {hasReacted ? REACTION_CONFIG[userReaction]?.emoji : 'üëç'}\n              </span>\n              <span className=\"text-sm font-medium\">\n                {hasReacted ? REACTION_CONFIG[userReaction]?.label : 'Like'}\n              </span>\n            </button>\n\n            {/* Reaction picker popup */}\n            <AnimatePresence>\n              {showPicker && (\n                <motion.div\n                  initial={{ opacity: 0, scale: 0.8, y: 10 }}\n                  animate={{ opacity: 1, scale: 1, y: 0 }}\n                  exit={{ opacity: 0, scale: 0.8, y: 10 }}\n                  className=\"absolute bottom-full left-0 mb-2 z-50\"\n                  onMouseEnter={() => setIsHovering(true)}\n                  onMouseLeave={() => {\n                    setIsHovering(false);\n                    setShowPicker(false);\n                  }}\n                >\n                  <div className=\"bg-white dark:bg-gray-800 rounded-full shadow-xl border border-gray-200 dark:border-gray-700 p-2 flex space-x-1\">\n                    {Object.entries(REACTION_CONFIG).map(([reactionType, config]) => {\n                      const isActive = userReaction === reactionType;\n                      const count = reactions?.[reactionType as ReactionType] || 0;\n                      \n                      return (\n                        <motion.button\n                          key={reactionType}\n                          whileHover={{ scale: 1.3, y: -4 }}\n                          whileTap={{ scale: 0.9 }}\n                          onClick={() => handleReactionClick(reactionType as ReactionType)}\n                          className={`relative p-2 rounded-full transition-all duration-200 ${\n                            isActive\n                              ? 'bg-blue-100 dark:bg-blue-900 scale-110 shadow-lg'\n                              : 'hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer'\n                          }`}\n                          title={`${config.label}${count > 0 ? ` (${count})` : ''}`}\n                        >\n                          <span className=\"text-xl\">{config.emoji}</span>\n                          \n                          {/* Count badge */}\n                          {count > 0 && (\n                            <motion.div\n                              initial={{ scale: 0 }}\n                              animate={{ scale: 1 }}\n                              className=\"absolute -top-1 -right-1 bg-blue-600 text-white text-xs rounded-full min-w-[16px] h-4 flex items-center justify-center px-1\"\n                            >\n                              {count}\n                            </motion.div>\n                          )}\n                        </motion.button>\n                      );\n                    })}\n                  </div>\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </div>\n\n          {/* Comment button */}\n          <button \n            onClick={onCommentClick}\n            className=\"flex items-center space-x-2 px-4 py-2 rounded-md text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors\"\n          >\n            <ChatBubbleLeftIcon className=\"h-5 w-5\" />\n            <span className=\"text-sm font-medium\">Comment</span>\n          </button>\n\n          {/* Share button */}\n          <button \n            onClick={onShareClick}\n            className=\"flex items-center space-x-2 px-4 py-2 rounded-md text-gray-600 dark:text-gray-400 hover:text-green-600 dark:hover:text-green-400 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors\"\n          >\n            <ShareIcon className=\"h-5 w-5\" />\n            <span className=\"text-sm font-medium\">Share</span>\n          </button>\n        </div>\n      </div>\n\n      {/* Backdrop to close picker */}\n      {showPicker && (\n        <div\n          className=\"fixed inset-0 z-40\"\n          onClick={() => setShowPicker(false)}\n        />\n      )}\n\n      {/* Reactions Modal */}\n      <ReactionsModal\n        isOpen={showReactionsModal}\n        onClose={() => setShowReactionsModal(false)}\n        postId={postId}\n      />\n    </div>\n  );\n};\n\nexport default LinkedInReactions;","import React, { useState } from 'react';\nimport { Dialog, Transition } from '@headlessui/react';\nimport { Fragment } from 'react';\nimport { XMarkIcon } from '@heroicons/react/24/outline';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { useGetCommentReactionUsersQuery } from '../../../store/api/postApi';\nimport type { ReactionType } from '../../../types/post';\nimport { Link } from 'react-router-dom';\nimport { formatDistanceToNow } from 'date-fns';\n\ninterface CommentReactionsModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  postId: string;\n  commentId: string;\n}\n\nconst REACTION_CONFIG: Record<ReactionType, { emoji: string; label: string; color: string }> = {\n  LIKE: { emoji: 'üëç', label: 'Like', color: 'text-blue-600 dark:text-blue-400' },\n  LOVE: { emoji: '‚ù§Ô∏è', label: 'Love', color: 'text-red-600 dark:text-red-400' },\n  CELEBRATE: { emoji: 'üéâ', label: 'Celebrate', color: 'text-yellow-600 dark:text-yellow-400' },\n  SUPPORT: { emoji: 'üôå', label: 'Support', color: 'text-green-600 dark:text-green-400' },\n  FUNNY: { emoji: 'üòÇ', label: 'Funny', color: 'text-orange-600 dark:text-orange-400' },\n  WOW: { emoji: 'üòÆ', label: 'Wow', color: 'text-purple-600 dark:text-purple-400' },\n  ANGRY: { emoji: 'üò†', label: 'Angry', color: 'text-red-700 dark:text-red-300' },\n  SAD: { emoji: 'üò¢', label: 'Sad', color: 'text-blue-700 dark:text-blue-300' },\n};\n\nconst CommentReactionsModal: React.FC<CommentReactionsModalProps> = ({\n  isOpen,\n  onClose,\n  postId,\n  commentId,\n}) => {\n  const [selectedTab, setSelectedTab] = useState<string>('ALL');\n  const [page, setPage] = useState(1);\n\n  const {\n    data: reactionsData,\n    isLoading,\n    error,\n  } = useGetCommentReactionUsersQuery(\n    { \n      postId,\n      commentId,\n      reactionType: selectedTab === 'ALL' ? undefined : selectedTab,\n      page,\n      limit: 20 \n    },\n    { skip: !isOpen }\n  );\n\n  const getInitials = (name: string) => {\n    return name\n      .split(' ')\n      .map(word => word.charAt(0))\n      .join('')\n      .slice(0, 2)\n      .toUpperCase();\n  };\n\n  // Get available reaction types with counts\n  const availableReactions = reactionsData?.reactionCounts \n    ? Object.entries(reactionsData.reactionCounts)\n        .filter(([_, count]) => count > 0)\n        .sort(([a, countA], [b, countB]) => {\n          if (a === 'ALL') return -1;\n          if (b === 'ALL') return 1;\n          return countB - countA; // Sort by count descending\n        })\n    : [];\n\n  const totalReactions = availableReactions.reduce((sum, [_, count]) => sum + count, 0);\n\n  return (\n    <Transition appear show={isOpen} as={Fragment}>\n      <Dialog as=\"div\" className=\"relative z-50\" onClose={onClose}>\n        <Transition.Child\n          as={Fragment}\n          enter=\"ease-out duration-300\"\n          enterFrom=\"opacity-0\"\n          enterTo=\"opacity-100\"\n          leave=\"ease-in duration-200\"\n          leaveFrom=\"opacity-100\"\n          leaveTo=\"opacity-0\"\n        >\n          <div className=\"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm\" />\n        </Transition.Child>\n\n        <div className=\"fixed inset-0 overflow-y-auto\">\n          <div className=\"flex min-h-full items-center justify-center p-4 text-center\">\n            <Transition.Child\n              as={Fragment}\n              enter=\"ease-out duration-300\"\n              enterFrom=\"opacity-0 scale-95\"\n              enterTo=\"opacity-100 scale-100\"\n              leave=\"ease-in duration-200\"\n              leaveFrom=\"opacity-100 scale-100\"\n              leaveTo=\"opacity-0 scale-95\"\n            >\n              <Dialog.Panel className=\"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-6 text-left align-middle shadow-xl transition-all\">\n                {/* Header */}\n                <div className=\"flex items-center justify-between mb-4\">\n                  <Dialog.Title\n                    as=\"h3\"\n                    className=\"text-lg font-medium leading-6 text-gray-900 dark:text-white\"\n                  >\n                    Reactions\n                  </Dialog.Title>\n                  <button\n                    onClick={onClose}\n                    className=\"rounded-md p-2 text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                {/* Reaction Tabs */}\n                {availableReactions.length > 0 && (\n                  <div className=\"flex space-x-1 mb-4 overflow-x-auto\">\n                    {/* Add ALL tab with total count */}\n                    <button\n                      onClick={() => {\n                        setSelectedTab('ALL');\n                        setPage(1);\n                      }}\n                      className={`flex items-center space-x-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${\n                        selectedTab === 'ALL'\n                          ? 'bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300'\n                          : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700'\n                      }`}\n                    >\n                      <span>All</span>\n                      <span className=\"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 px-2 py-0.5 rounded-full text-xs\">\n                        {totalReactions}\n                      </span>\n                    </button>\n                    \n                    {availableReactions.map(([reactionType, count]) => (\n                      <button\n                        key={reactionType}\n                        onClick={() => {\n                          setSelectedTab(reactionType);\n                          setPage(1);\n                        }}\n                        className={`flex items-center space-x-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${\n                          selectedTab === reactionType\n                            ? 'bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300'\n                            : 'text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700'\n                        }`}\n                      >\n                        <span className=\"text-base\">\n                          {REACTION_CONFIG[reactionType as ReactionType]?.emoji}\n                        </span>\n                        <span className=\"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 px-2 py-0.5 rounded-full text-xs\">\n                          {count}\n                        </span>\n                      </button>\n                    ))}\n                  </div>\n                )}\n\n                {/* Reactions List */}\n                <div className=\"h-96 overflow-y-auto\">\n                  {isLoading ? (\n                    <div className=\"flex justify-center py-8\">\n                      <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n                    </div>\n                  ) : error ? (\n                    <div className=\"text-center py-8 text-red-600 dark:text-red-400\">\n                      Failed to load reactions\n                    </div>\n                  ) : reactionsData?.reactions?.length === 0 ? (\n                    <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                      No reactions found\n                    </div>\n                  ) : (\n                    <div className=\"space-y-3\">\n                      <AnimatePresence mode=\"popLayout\">\n                        {reactionsData?.reactions?.map((reaction, index) => (\n                          <motion.div\n                            key={reaction.id}\n                            initial={{ opacity: 0, y: 20 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            exit={{ opacity: 0, y: -20 }}\n                            transition={{ duration: 0.2, delay: index * 0.05 }}\n                            className=\"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700\"\n                          >\n                            {/* Profile Picture */}\n                            <div className=\"relative\">\n                              {reaction.user.profileImage ? (\n                                <img\n                                  src={`/api/users/profile-picture/${reaction.user.id}`}\n                                  alt={reaction.user.fullName}\n                                  className=\"h-10 w-10 rounded-full object-cover\"\n                                />\n                              ) : (\n                                <div className=\"h-10 w-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-sm\">\n                                  {getInitials(reaction.user.fullName)}\n                                </div>\n                              )}\n                              \n                              {/* Reaction Emoji Badge */}\n                              <div className=\"absolute -bottom-0.5 -right-0.5 bg-white dark:bg-gray-800 rounded-full p-0.5 border border-gray-200 dark:border-gray-600 w-5 h-5 flex items-center justify-center\">\n                                <span className=\"text-xs\">\n                                  {REACTION_CONFIG[reaction.reactionType]?.emoji}\n                                </span>\n                              </div>\n                            </div>\n\n                            {/* User Info */}\n                            <div className=\"flex-1 min-w-0\">\n                              <Link\n                                to={`/alumni/${reaction.user.id}`}\n                                className=\"block hover:text-blue-600 dark:hover:text-blue-400\"\n                              >\n                                <p className=\"text-sm font-medium text-gray-900 dark:text-white truncate\">\n                                  {reaction.user.fullName}\n                                </p>\n                                <p className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">\n                                  {reaction.user.workHistory && reaction.user.workHistory.length > 0\n                                    ? `${reaction.user.workHistory[0].jobRole} at ${reaction.user.workHistory[0].companyName}`\n                                    : (reaction.user.batch && `Batch ${reaction.user.batch}`) || 'Alumni'\n                                  }\n                                </p>\n                              </Link>\n                              <p className=\"text-xs text-gray-400 dark:text-gray-500\">\n                                {formatDistanceToNow(new Date(reaction.createdAt), { addSuffix: true })}\n                              </p>\n                            </div>\n                          </motion.div>\n                        ))}\n                      </AnimatePresence>\n                    </div>\n                  )}\n                </div>\n\n                {/* Pagination */}\n                {reactionsData?.pagination && reactionsData.pagination.pages > 1 && (\n                  <div className=\"flex justify-between items-center mt-4 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                    <button\n                      onClick={() => setPage(p => Math.max(1, p - 1))}\n                      disabled={!reactionsData.pagination.hasPrev}\n                      className=\"px-3 py-1 text-sm rounded-md bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      Previous\n                    </button>\n                    \n                    <span className=\"text-sm text-gray-500 dark:text-gray-400\">\n                      Page {reactionsData.pagination.page} of {reactionsData.pagination.pages}\n                    </span>\n                    \n                    <button\n                      onClick={() => setPage(p => p + 1)}\n                      disabled={!reactionsData.pagination.hasNext}\n                      className=\"px-3 py-1 text-sm rounded-md bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      Next\n                    </button>\n                  </div>\n                )}\n              </Dialog.Panel>\n            </Transition.Child>\n          </div>\n        </div>\n      </Dialog>\n    </Transition>\n  );\n};\n\nexport default CommentReactionsModal;","import React, { useState, useRef, useCallback, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { formatDistanceToNow } from 'date-fns';\nimport { EllipsisHorizontalIcon, PencilIcon, TrashIcon } from '@heroicons/react/24/outline';\nimport { \n  useGetPostCommentsQuery, \n  useCreateCommentMutation, \n  useCreateReplyMutation,\n  useToggleCommentReactionMutation,\n  useUpdateCommentMutation,\n  useDeleteCommentMutation\n} from '../../../store/api/postApi';\nimport type { Comment, ReactionType } from '../../../types/post';\nimport { useAuth } from '../../../hooks/useAuth';\nimport CommentReactionsModal from './CommentReactionsModal';\n\ninterface CommentsSectionProps {\n  postId: string;\n  allowComments: boolean;\n}\n\nconst REACTION_CONFIG: Record<ReactionType, { emoji: string; label: string; color: string }> = {\n  LIKE: { emoji: 'üëç', label: 'Like', color: 'text-blue-600 dark:text-blue-400' },\n  LOVE: { emoji: '‚ù§Ô∏è', label: 'Love', color: 'text-red-600 dark:text-red-400' },\n  CELEBRATE: { emoji: 'üéâ', label: 'Celebrate', color: 'text-yellow-600 dark:text-yellow-400' },\n  SUPPORT: { emoji: 'üôå', label: 'Support', color: 'text-green-600 dark:text-green-400' },\n  FUNNY: { emoji: 'üòÇ', label: 'Funny', color: 'text-orange-600 dark:text-orange-400' },\n  WOW: { emoji: 'üòÆ', label: 'Wow', color: 'text-purple-600 dark:text-purple-400' },\n  ANGRY: { emoji: 'üò†', label: 'Angry', color: 'text-red-700 dark:text-red-300' },\n  SAD: { emoji: 'üò¢', label: 'Sad', color: 'text-blue-700 dark:text-blue-300' },\n};\n\nconst CommentsSection: React.FC<CommentsSectionProps> = ({ postId, allowComments }) => {\n  const { user } = useAuth();\n  const [sortOrder, setSortOrder] = useState<'desc' | 'asc'>('desc');\n  const [showReactionsModal, setShowReactionsModal] = useState<{ commentId: string; isOpen: boolean } | null>(null);\n  const [currentLimit, setCurrentLimit] = useState(2); // Start with 2 comments\n  \n  const { \n    data: commentsData, \n    isLoading: commentsLoading,\n    error: commentsError\n  } = useGetPostCommentsQuery({ postId, page: 1, limit: currentLimit, sortOrder });\n  \n  const [createComment, { isLoading: creatingComment }] = useCreateCommentMutation();\n  const [createReply, { isLoading: creatingReply }] = useCreateReplyMutation();\n  const [toggleCommentReaction] = useToggleCommentReactionMutation();\n  const [updateComment, { isLoading: updatingComment }] = useUpdateCommentMutation();\n  const [deleteComment] = useDeleteCommentMutation();\n  const [loadedImages, setLoadedImages] = useState<Set<string>>(new Set());\n\n  const getInitials = (name: string) => {\n    return name\n      .split(' ')\n      .map(word => word.charAt(0))\n      .join('')\n      .slice(0, 2)\n      .toUpperCase();\n  };\n\n  const getAvatarColor = (userId: string): string => {\n    const colors = [\n      'from-blue-500 to-purple-600',\n      'from-green-500 to-teal-600',\n      'from-pink-500 to-red-600',\n      'from-yellow-500 to-orange-600',\n      'from-indigo-500 to-blue-600',\n      'from-purple-500 to-pink-600',\n      'from-teal-500 to-green-600',\n      'from-orange-500 to-red-600',\n    ];\n    \n    // Use user ID to consistently generate the same color for each user\n    const colorIndex = userId.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0) % colors.length;\n    return colors[colorIndex];\n  };\n\n  const handleImageLoad = (userId: string, e: React.SyntheticEvent<HTMLImageElement>) => {\n    const img = e.target as HTMLImageElement;\n    // Check if it's a real image (not a tiny placeholder)\n    if (img.naturalWidth > 50 && img.naturalHeight > 50) {\n      setLoadedImages(prev => new Set(prev).add(userId));\n    }\n  };\n\n  const handleReactionClick = async (commentId: string, reactionType: ReactionType) => {\n    if (!user) return;\n    \n    try {\n      await toggleCommentReaction({\n        postId,\n        commentId,\n        reactionType,\n      }).unwrap();\n      setShowReactionsModal(null);\n    } catch (error) {\n      console.error('Failed to toggle reaction:', error);\n    }\n  };\n\n\n  const handleDeleteComment = async (commentId: string) => {\n    if (!user || !window.confirm('Are you sure you want to delete this comment?')) return;\n    \n    try {\n      await deleteComment({ postId, commentId }).unwrap();\n    } catch (error) {\n      console.error('Failed to delete comment:', error);\n    }\n  };\n\n\n  // Simple LinkedIn-style input component\n  const CommentInput: React.FC<{\n    placeholder: string;\n    onSubmit: (content: string) => Promise<void>;\n    isLoading: boolean;\n    buttonText: string;\n    autoFocus?: boolean;\n  }> = ({ placeholder, onSubmit, isLoading, buttonText, autoFocus = false }) => {\n    const [text, setText] = useState('');\n    const [isFocused, setIsFocused] = useState(false);\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n    const handleSubmit = useCallback(async () => {\n      if (!text.trim()) return;\n      \n      try {\n        await onSubmit(text.trim());\n        setText('');\n        setIsFocused(false);\n        if (textareaRef.current) {\n          textareaRef.current.style.height = '36px';\n        }\n      } catch (error) {\n        console.error('Failed to submit:', error);\n      }\n    }, [text, onSubmit]);\n\n    const handleTextChange = useCallback((e: React.ChangeEvent<HTMLTextAreaElement>) => {\n      setText(e.target.value);\n      // Auto-resize\n      const target = e.target;\n      target.style.height = '36px';\n      target.style.height = Math.min(target.scrollHeight, 120) + 'px';\n    }, []);\n\n    const handleKeyPress = useCallback((e: React.KeyboardEvent) => {\n      if (e.key === 'Enter' && !e.shiftKey) {\n        e.preventDefault();\n        handleSubmit();\n      }\n    }, [handleSubmit]);\n\n    const handleFocus = useCallback(() => {\n      setIsFocused(true);\n    }, []);\n\n    const handleBlur = useCallback(() => {\n      if (!text.trim()) {\n        setIsFocused(false);\n      }\n    }, [text]);\n\n    return (\n      <div className=\"relative\">\n        <textarea\n          ref={textareaRef}\n          value={text}\n          onChange={handleTextChange}\n          onKeyPress={handleKeyPress}\n          onFocus={handleFocus}\n          onBlur={handleBlur}\n          placeholder={placeholder}\n          autoFocus={autoFocus}\n          className={`w-full resize-none focus:outline-none text-sm dark:text-white placeholder-gray-500 dark:placeholder-gray-400 border rounded-lg px-3 py-2 transition-colors ${\n            isFocused \n              ? 'border-blue-500 bg-white dark:bg-gray-700' \n              : 'border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 hover:bg-white dark:hover:bg-gray-700'\n          }`}\n          rows={1}\n          style={{ minHeight: '40px', maxHeight: '120px', lineHeight: '18px' }}\n        />\n        {(isFocused || text.trim()) && (\n          <div className=\"flex justify-between mt-2\">\n            <button\n              onClick={() => {\n                setText('');\n                setIsFocused(false);\n              }}\n              className=\"px-4 py-1 bg-gray-500 text-white rounded-lg text-sm font-medium hover:bg-gray-600 transition-colors\"\n            >\n              Cancel\n            </button>\n            <button\n              onClick={handleSubmit}\n              disabled={!text.trim() || isLoading}\n              className=\"px-4 py-1 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            >\n              {isLoading ? 'Posting...' : buttonText}\n            </button>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  // Unified comment component for both comments and replies\n  const CommentItem: React.FC<{ \n    comment: Comment; \n    isReply?: boolean;\n    level?: number;\n  }> = React.memo(({ comment, isReply = false, level = 0 }) => {\n    const [showReplyInput, setShowReplyInput] = useState(false);\n    const [showReactionPicker, setShowReactionPicker] = useState(false);\n    const [editingComment, setEditingComment] = useState<{ id: string; content: string } | null>(null);\n    const [showCommentMenu, setShowCommentMenu] = useState(false);\n    const [showAllReplies, setShowAllReplies] = useState(false);\n    const isAuthor = comment.author.id === user?.id;\n    const userReaction = comment.userReaction;\n    const hasReplies = comment.replies && comment.replies.length > 0;\n    const replyCount = comment.replies ? comment.replies.length : 0;\n\n    const handleCreateReply = async (content: string) => {\n      await createReply({\n        postId,\n        commentId: comment.id,\n        content,\n        mentions: [],\n      }).unwrap();\n      setShowReplyInput(false);\n    };\n\n    const handleReactionToggle = (reactionType: ReactionType) => {\n      handleReactionClick(comment.id, reactionType);\n      setShowReactionPicker(false);\n    };\n\n    const handleEditThisComment = () => {\n      setEditingComment({ id: comment.id, content: comment.content });\n      setShowCommentMenu(false); // Close menu\n    };\n\n    const handleUpdateThisComment = async (content: string) => {\n      if (!user || !content.trim()) return;\n      \n      try {\n        await updateComment({ postId, commentId: comment.id, content }).unwrap();\n        setEditingComment(null);\n      } catch (error) {\n        console.error('Failed to update comment:', error);\n      }\n    };\n\n    const handleEditContentChange = useCallback((value: string) => {\n      setEditingComment(prev => prev ? { ...prev, content: value } : null);\n    }, []);\n\n    const menuRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n      const handleClickOutside = (event: MouseEvent) => {\n        if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n          setShowCommentMenu(false);\n        }\n      };\n\n      if (showCommentMenu) {\n        document.addEventListener('mousedown', handleClickOutside);\n        return () => document.removeEventListener('mousedown', handleClickOutside);\n      }\n    }, [showCommentMenu]);\n\n    return (\n      <motion.div\n        layout\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className={`${isReply ? 'ml-10 mt-2' : 'mb-3'}`}\n      >\n        <div className=\"flex space-x-3\">\n          {/* Profile Picture */}\n          <div className=\"flex-shrink-0 mt-1\">\n            {loadedImages.has(comment.author.id) ? (\n              <img\n                src={`/api/users/profile-picture/${comment.author.id}`}\n                alt={comment.author.fullName}\n                className=\"h-8 w-8 rounded-full object-cover\"\n              />\n            ) : (\n              <>\n                <img\n                  src={`/api/users/profile-picture/${comment.author.id}`}\n                  alt={comment.author.fullName}\n                  className=\"h-8 w-8 rounded-full object-cover opacity-0 absolute\"\n                  onLoad={(e) => handleImageLoad(comment.author.id, e)}\n                />\n                <div className={`h-8 w-8 rounded-full bg-gradient-to-br ${getAvatarColor(comment.author.id)} flex items-center justify-center text-white font-semibold text-xs`}>\n                  {getInitials(comment.author.fullName)}\n                </div>\n              </>\n            )}\n          </div>\n\n          {/* Comment Content */}\n          <div className=\"flex-1 min-w-0\">\n            {/* Comment Content */}\n            <div className=\"py-1\">\n              <div className=\"flex items-start justify-between mb-1\">\n                <div className=\"flex flex-col\">\n                  <div className=\"flex items-center space-x-2\">\n                    <span className=\"font-medium text-sm text-gray-900 dark:text-white\">\n                      {comment.author.fullName}\n                    </span>\n                    {isAuthor && (\n                      <span className=\"text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 px-1.5 py-0.5 rounded\">\n                        Author\n                      </span>\n                    )}\n                  </div>\n                  {comment.author.batch && (\n                    <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                      Batch {comment.author.batch}\n                    </span>\n                  )}\n                </div>\n                \n                {/* 3-dot menu for comment author */}\n                {user && user.id === comment.createdBy && (\n                  <div className=\"relative\" ref={menuRef}>\n                    <button\n                      onClick={() => setShowCommentMenu(!showCommentMenu)}\n                      className=\"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-full transition-colors\"\n                    >\n                      <EllipsisHorizontalIcon className=\"h-4 w-4 text-gray-500 dark:text-gray-400\" />\n                    </button>\n                    \n                    <AnimatePresence>\n                      {showCommentMenu && (\n                        <motion.div\n                          initial={{ opacity: 0, scale: 0.8, y: -10 }}\n                          animate={{ opacity: 1, scale: 1, y: 0 }}\n                          exit={{ opacity: 0, scale: 0.8, y: -10 }}\n                          className=\"absolute right-0 mt-2 w-32 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-md shadow-lg z-20\"\n                        >\n                          <div className=\"py-1\">\n                            <button\n                              onClick={handleEditThisComment}\n                              className=\"flex items-center w-full px-3 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700\"\n                            >\n                              <PencilIcon className=\"h-4 w-4 mr-2\" />\n                              Edit\n                            </button>\n                            <button\n                              onClick={() => {\n                                handleDeleteComment(comment.id);\n                                setShowCommentMenu(false);\n                              }}\n                              className=\"flex items-center w-full px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700\"\n                            >\n                              <TrashIcon className=\"h-4 w-4 mr-2\" />\n                              Delete\n                            </button>\n                          </div>\n                        </motion.div>\n                      )}\n                    </AnimatePresence>\n                  </div>\n                )}\n              </div>\n              {editingComment?.id === comment.id ? (\n                <div className=\"space-y-2\">\n                  <textarea\n                    value={editingComment.content}\n                    onChange={(e) => handleEditContentChange(e.target.value)}\n                    className=\"w-full text-sm bg-transparent border border-gray-300 dark:border-gray-600 rounded px-2 py-1 focus:outline-none focus:border-blue-500\"\n                    rows={2}\n                    autoFocus\n                  />\n                  <div className=\"flex space-x-2\">\n                    <button\n                      onClick={() => handleUpdateThisComment(editingComment.content)}\n                      disabled={updatingComment}\n                      className=\"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50\"\n                    >\n                      {updatingComment ? 'Saving...' : 'Save'}\n                    </button>\n                    <button\n                      onClick={() => setEditingComment(null)}\n                      className=\"px-3 py-1 text-xs bg-gray-500 text-white rounded hover:bg-gray-600\"\n                    >\n                      Cancel\n                    </button>\n                  </div>\n                </div>\n              ) : (\n                <>\n                  <p className=\"text-sm text-gray-800 dark:text-gray-200 leading-normal\">\n                    {comment.content}\n                  </p>\n                  {comment.isEdited && (\n                    <span className=\"text-xs text-gray-500 dark:text-gray-400 italic\">edited</span>\n                  )}\n                </>\n              )}\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex items-center space-x-3 mt-1 ml-3\">\n              {/* Like Button (for showing reaction picker) */}\n              <div className=\"relative\">\n                <button\n                  onClick={() => setShowReactionPicker(!showReactionPicker)}\n                  className={`flex items-center space-x-1 px-2 py-1 rounded text-xs font-medium transition-colors ${\n                    userReaction\n                      ? 'text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20'\n                      : 'text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700'\n                  }`}\n                >\n                  <span>Like</span>\n                  {userReaction && (\n                    <span className=\"text-sm\">{REACTION_CONFIG[userReaction].emoji}</span>\n                  )}\n                </button>\n\n                {/* Reaction Picker */}\n                <AnimatePresence>\n                  {showReactionPicker && (\n                    <motion.div\n                      initial={{ opacity: 0, scale: 0.8, y: 10 }}\n                      animate={{ opacity: 1, scale: 1, y: 0 }}\n                      exit={{ opacity: 0, scale: 0.8, y: 10 }}\n                      className=\"absolute bottom-full left-0 mb-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-full shadow-lg px-2 py-1 flex space-x-1 z-10\"\n                    >\n                      {Object.entries(REACTION_CONFIG).map(([reactionType, config]) => (\n                        <button\n                          key={reactionType}\n                          onClick={() => handleReactionToggle(reactionType as ReactionType)}\n                          className=\"hover:scale-125 transition-transform p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700\"\n                          title={config.label}\n                        >\n                          <span className=\"text-xl\">{config.emoji}</span>\n                        </button>\n                      ))}\n                    </motion.div>\n                  )}\n                </AnimatePresence>\n              </div>\n              \n              {/* Reaction Count Button (opens modal) */}\n              {comment.totalReactions > 0 && (\n                <button\n                  onClick={() => setShowReactionsModal({ commentId: comment.id, isOpen: true })}\n                  className=\"flex items-center space-x-1 text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 text-xs font-medium\"\n                >\n                  <span className=\"text-sm\">\n                    {comment.reactions && Object.entries(comment.reactions)\n                      .filter(([, count]) => count > 0)\n                      .slice(0, 3)\n                      .map(([reactionType]) => REACTION_CONFIG[reactionType as ReactionType]?.emoji)\n                      .join('')\n                    }\n                  </span>\n                  <span>({comment.totalReactions})</span>\n                </button>\n              )}\n              \n              {/* Reply Button */}\n              <button\n                onClick={() => setShowReplyInput(!showReplyInput)}\n                className=\"text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 text-xs font-medium\"\n              >\n                Reply{replyCount > 0 && ` ¬∑ ${replyCount} ${replyCount === 1 ? 'reply' : 'replies'}`}\n              </button>\n              \n              <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                {formatDistanceToNow(new Date(comment.createdAt), { addSuffix: true })}\n              </span>\n            </div>\n\n            {/* Reply Input */}\n            {showReplyInput && (\n              <motion.div\n                initial={{ opacity: 0, height: 0 }}\n                animate={{ opacity: 1, height: 'auto' }}\n                exit={{ opacity: 0, height: 0 }}\n                className=\"mt-3 ml-4\"\n              >\n                <div className=\"flex items-start space-x-3\">\n                  <div className=\"flex-shrink-0 mt-1\">\n                    <img\n                      src={`/api/users/profile-picture/${user?.id}`}\n                      alt={user?.fullName || ''}\n                      className=\"h-6 w-6 rounded-full object-cover\"\n                      onLoad={(e) => {\n                        const target = e.target as HTMLImageElement;\n                        // Check if image is very small (likely a placeholder/default image)\n                        if (target.naturalWidth <= 50 || target.naturalHeight <= 50) {\n                          const parent = target.parentElement;\n                          if (parent) {\n                            parent.innerHTML = `<div class=\"h-6 w-6 rounded-full bg-gradient-to-br ${getAvatarColor(user?.id || '')} flex items-center justify-center text-white font-semibold text-xs\">${getInitials(user?.fullName || '')}</div>`;\n                          }\n                        }\n                      }}\n                      onError={(e) => {\n                        const target = e.target as HTMLImageElement;\n                        const parent = target.parentElement;\n                        if (parent) {\n                          parent.innerHTML = `<div class=\"h-6 w-6 rounded-full bg-gradient-to-br ${getAvatarColor(user?.id || '')} flex items-center justify-center text-white font-semibold text-xs\">${getInitials(user?.fullName || '')}</div>`;\n                        }\n                      }}\n                    />\n                  </div>\n                  <div className=\"flex-1\">\n                    <CommentInput\n                      placeholder=\"Write a reply...\"\n                      onSubmit={handleCreateReply}\n                      isLoading={creatingReply}\n                      buttonText=\"Reply\"\n                      autoFocus={true}\n                    />\n                  </div>\n                </div>\n              </motion.div>\n            )}\n\n            {/* Nested Replies */}\n            {hasReplies && !isReply && (\n              <div className=\"mt-3 ml-6\">\n                {/* Show All Replies or Collapsed View */}\n                {replyCount > 1 && !showAllReplies ? (\n                  <div>\n                    {/* See Previous Replies Button */}\n                    <button\n                      onClick={() => setShowAllReplies(true)}\n                      className=\"text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 font-medium mb-3 flex items-center\"\n                    >\n                      <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n                      </svg>\n                      See previous {replyCount - 1} {replyCount - 1 === 1 ? 'reply' : 'replies'}\n                    </button>\n                    \n                    {/* Latest reply */}\n                    <CommentItem \n                      key={comment.replies[comment.replies.length - 1].id}\n                      comment={comment.replies[comment.replies.length - 1]} \n                      isReply={true}\n                      level={level + 1}\n                    />\n                  </div>\n                ) : (\n                  <div>\n                    {/* Show all replies */}\n                    {comment.replies.map((reply, index) => (\n                      <div key={reply.id} className=\"mb-3\">\n                        {replyCount > 1 && showAllReplies && index === 0 && (\n                          <button\n                            onClick={() => setShowAllReplies(false)}\n                            className=\"text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 font-medium mb-3 flex items-center\"\n                          >\n                            <svg className=\"w-4 h-4 mr-1\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 15l7-7 7 7\" />\n                            </svg>\n                            Hide previous replies\n                          </button>\n                        )}\n                        \n                        <CommentItem \n                          comment={reply} \n                          isReply={true}\n                          level={level + 1}\n                        />\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            )}\n            \n            {/* Show replies for nested comments (when isReply = true) */}\n            {hasReplies && isReply && (\n              <div className=\"mt-3 ml-6\">\n                {comment.replies.map((reply) => (\n                  <CommentItem \n                    key={reply.id} \n                    comment={reply} \n                    isReply={true}\n                    level={level + 1}\n                  />\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n      </motion.div>\n    );\n  });\n\n  const handleCreateComment = async (content: string) => {\n    await createComment({\n      postId,\n      content,\n      mentions: [],\n    }).unwrap();\n  };\n\n  const toggleSortOrder = () => {\n    setSortOrder(prev => prev === 'desc' ? 'asc' : 'desc');\n    setCurrentLimit(2); // Reset to initial limit when sorting changes\n  };\n\n  const loadMoreComments = () => {\n    setCurrentLimit(prev => prev + 5); // Load 5 more comments\n  };\n\n  // Check if there are more comments to load\n  const hasMoreComments = commentsData?.pagination && commentsData.pagination.hasNext;\n\n  if (!allowComments) {\n    return null;\n  }\n\n  return (\n    <div className=\"px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50\">\n      {/* Comments Header */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\n          {commentsData?.pagination.totalAllComments || commentsData?.pagination.total || 0} comments\n        </span>\n        <button\n          onClick={toggleSortOrder}\n          className=\"text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors font-medium\"\n        >\n{sortOrder === 'desc' ? 'Oldest first' : 'Newest first'}\n        </button>\n      </div>\n\n      {/* Create Comment */}\n      {user && (\n        <div className=\"flex items-start space-x-3 mb-4\">\n          <div className=\"flex-shrink-0 mt-1\">\n            {loadedImages.has(user.id) ? (\n              <img\n                src={`/api/users/profile-picture/${user.id}`}\n                alt={user.fullName}\n                className=\"h-8 w-8 rounded-full object-cover\"\n              />\n            ) : (\n              <>\n                <img\n                  src={`/api/users/profile-picture/${user.id}`}\n                  alt={user.fullName}\n                  className=\"h-8 w-8 rounded-full object-cover opacity-0 absolute\"\n                  onLoad={(e) => handleImageLoad(user.id, e)}\n                />\n                <div className={`h-8 w-8 rounded-full bg-gradient-to-br ${getAvatarColor(user.id)} flex items-center justify-center text-white font-semibold text-xs`}>\n                  {getInitials(user.fullName)}\n                </div>\n              </>\n            )}\n          </div>\n          <div className=\"flex-1\">\n            <CommentInput\n              placeholder=\"Add a comment...\"\n              onSubmit={handleCreateComment}\n              isLoading={creatingComment}\n              buttonText=\"Comment\"\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Comments List */}\n      <div className=\"space-y-3\">\n        {commentsLoading ? (\n          <div className=\"flex justify-center py-8\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          </div>\n        ) : commentsError ? (\n          <div className=\"text-center py-8 text-red-600 dark:text-red-400\">\n            Failed to load comments\n          </div>\n        ) : commentsData?.comments?.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            No comments yet. Be the first to comment!\n          </div>\n        ) : (\n          <AnimatePresence>\n            {commentsData?.comments?.map((comment) => (\n              <CommentItem key={comment.id} comment={comment} />\n            ))}\n          </AnimatePresence>\n        )}\n      </div>\n\n      {/* Load More Comments */}\n      {hasMoreComments && (\n        <div className=\"mt-4 pt-3 border-t border-gray-100 dark:border-gray-700\">\n          <button \n            onClick={loadMoreComments}\n            disabled={commentsLoading}\n            className=\"flex items-center space-x-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 font-medium text-sm transition-colors disabled:opacity-50\"\n          >\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n            </svg>\n            <span>{commentsLoading ? 'Loading...' : 'Load more comments'}</span>\n          </button>\n        </div>\n      )}\n\n      {/* Reactions Modal */}\n      {showReactionsModal && (\n        <CommentReactionsModal\n          isOpen={showReactionsModal.isOpen}\n          onClose={() => setShowReactionsModal(null)}\n          commentId={showReactionsModal.commentId}\n          postId={postId}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default CommentsSection;","import React, { useState } from 'react';\nimport { motion } from 'framer-motion';\nimport { Link } from 'react-router-dom';\nimport {\n  HeartIcon,\n  ChatBubbleLeftIcon,\n  ShareIcon,\n  EllipsisVerticalIcon,\n  EyeIcon,\n  PencilIcon,\n  TrashIcon,\n  ArchiveBoxIcon,\n  CheckCircleIcon,\n  XCircleIcon,\n  ClockIcon,\n} from '@heroicons/react/24/outline';\nimport {\n  HeartIcon as HeartSolidIcon,\n} from '@heroicons/react/24/solid';\nimport { Post } from '../../types/post';\nimport { useSelector } from 'react-redux';\nimport type { RootState } from '../../store';\nimport { \n  useToggleLikeMutation, \n  useToggleReactionMutation \n} from '../../store/api/postApi';\nimport type { ReactionType } from '../../types/post';\nimport { formatDistanceToNow } from 'date-fns';\nimport { Menu, Transition } from '@headlessui/react';\nimport { Fragment } from 'react';\nimport { Button } from '../common/UI/Button';\nimport LinkedInReactions from '../common/UI/LinkedInReactions';\nimport CommentsSection from '../common/UI/CommentsSection';\nimport PostImageDisplay from './PostImageDisplay';\nimport toast from 'react-hot-toast';\n\ninterface PostCardProps {\n  post: Post;\n  showActions?: boolean;\n  onEdit?: (post: Post) => void;\n  onDelete?: (postId: string) => void;\n  onArchive?: (postId: string) => void;\n  onApprove?: (postId: string, approved: boolean) => void;\n}\n\nconst PostCard: React.FC<PostCardProps> = ({\n  post,\n  showActions = true,\n  onEdit,\n  onDelete,\n  onArchive,\n  onApprove,\n}) => {\n  const { user } = useSelector((state: RootState) => state.auth);\n  const [showComments, setShowComments] = useState(false);\n  const [imageError, setImageError] = useState(false);\n  const [isExpanded, setIsExpanded] = useState(false);\n  \n  const [toggleLike, { isLoading: likingPost }] = useToggleLikeMutation();\n  const [toggleReaction, { isLoading: reactingToPost }] = useToggleReactionMutation();\n  \n  // Use reaction data from post object (already includes real-time data)\n  const defaultReactions: Record<ReactionType, number> = {\n    LIKE: 0,\n    LOVE: 0,\n    CELEBRATE: 0,\n    SUPPORT: 0,\n    FUNNY: 0,\n    WOW: 0,\n    ANGRY: 0,\n    SAD: 0,\n  };\n  \n  const reactionsData = {\n    reactions: { ...defaultReactions, ...post.reactionCounts },\n    userReactions: post.userReactions || [],\n    totalReactions: post.totalReactions || 0,\n  };\n  const loadingReactions = false; // Data is already available in post object\n\n\n  // Determine if user can perform actions\n  const canEdit = user?.id === post.createdBy || user?.role === 'SUPER_ADMIN';\n  const canDelete = user?.id === post.createdBy || user?.role === 'SUPER_ADMIN'; // Allow authors to delete their own posts\n  const canApprove = user?.role === 'SUPER_ADMIN' && !post.isPublished;\n  const canArchive = canEdit;\n\n  // Handle new reaction system\n  const handleReaction = async (reactionType: ReactionType) => {\n    if (!user) {\n      toast.error('Please login to react to posts');\n      return;\n    }\n\n    try {\n      await toggleReaction({ postId: post.id, reactionType }).unwrap();\n    } catch (error: any) {\n      console.error('Failed to toggle reaction:', error);\n      const errorMessage = error?.data?.message || 'Failed to update reaction';\n      toast.error(errorMessage);\n    }\n  };\n\n  // Legacy handler for backward compatibility  \n  const handleReactionToggle = async (reactionId: string) => {\n    // Map old reaction IDs to new types\n    const reactionMap: Record<string, ReactionType> = {\n      'like': 'LIKE',\n      'love': 'LOVE', \n      'celebrate': 'CELEBRATE',\n      'support': 'SUPPORT',\n      'funny': 'FUNNY',\n      'wow': 'WOW',\n      'angry': 'ANGRY',\n      'sad': 'SAD'\n    };\n    \n    const reactionType = reactionMap[reactionId] || 'LIKE';\n    await handleReaction(reactionType);\n  };\n\n  // Generate user initials\n  const getInitials = (name: string) => {\n    return name\n      .split(' ')\n      .map(word => word.charAt(0))\n      .join('')\n      .slice(0, 2)\n      .toUpperCase();\n  };\n\n  // Helper function to get plain text from HTML\n  const getPlainText = (html: string): string => {\n    const tempDiv = document.createElement('div');\n    tempDiv.innerHTML = html;\n    return tempDiv.textContent || tempDiv.innerText || '';\n  };\n\n  // Helper function to clean HTML content and remove unwanted link styling\n  const cleanHtmlContent = (html: string): string => {\n    const tempDiv = document.createElement('div');\n    tempDiv.innerHTML = html;\n\n    // Only remove anchor tags that are not mentions (keep mention functionality)\n    const anchors = tempDiv.querySelectorAll('a');\n    anchors.forEach(anchor => {\n      // Check if this is a mention (has data-user-id or mention class)\n      const isMention = anchor.hasAttribute('data-user-id') || \n                       anchor.classList.contains('mention') ||\n                       anchor.textContent?.startsWith('@');\n\n      if (isMention) {\n        // Convert mention links to styled spans to preserve mention appearance\n        const mentionSpan = document.createElement('span');\n        mentionSpan.className = 'mention bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 px-1 rounded font-medium';\n        mentionSpan.textContent = anchor.textContent || '';\n        if (anchor.hasAttribute('data-user-id')) {\n          mentionSpan.setAttribute('data-user-id', anchor.getAttribute('data-user-id') || '');\n        }\n        anchor.parentNode?.replaceChild(mentionSpan, anchor);\n      } else {\n        // Remove non-mention links but keep their text content\n        const textNode = document.createTextNode(anchor.textContent || '');\n        anchor.parentNode?.replaceChild(textNode, anchor);\n      }\n    });\n\n    // Only remove problematic attributes while keeping essential formatting\n    const allElements = tempDiv.querySelectorAll('*');\n    allElements.forEach(element => {\n      // Remove only navigation-related attributes\n      element.removeAttribute('href');\n      element.removeAttribute('data-discover');\n      \n      // Remove only problematic inline styles but keep essential formatting classes\n      const style = element.getAttribute('style');\n      if (style) {\n        // Remove specific problematic style properties while keeping others\n        const problematicStyles = [\n          'color: rgb(96, 165, 250)',\n          '--tw-text-opacity: 1'\n        ];\n        \n        let cleanedStyle = style;\n        problematicStyles.forEach(problemStyle => {\n          cleanedStyle = cleanedStyle.replace(new RegExp(problemStyle.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'gi'), '');\n        });\n        \n        // Clean up extra semicolons and spaces\n        cleanedStyle = cleanedStyle.replace(/;+/g, ';').replace(/;\\s*$/, '').trim();\n        \n        if (cleanedStyle) {\n          element.setAttribute('style', cleanedStyle);\n        } else {\n          element.removeAttribute('style');\n        }\n      }\n    });\n\n    return tempDiv.innerHTML;\n  };\n\n  // Helper function to truncate HTML content properly\n  const getTruncatedHtml = (html: string, maxLength: number): string => {\n    const cleanedHtml = cleanHtmlContent(html);\n    const plainText = getPlainText(cleanedHtml);\n    \n    if (plainText.length <= maxLength) {\n      return cleanedHtml;\n    }\n\n    // Simple approach: truncate based on plain text length\n    const words = plainText.split(' ');\n    let truncatedText = '';\n    for (const word of words) {\n      if ((truncatedText + ' ' + word).length > maxLength) {\n        break;\n      }\n      truncatedText += (truncatedText ? ' ' : '') + word;\n    }\n    \n    // For truncated content, just return the plain text to avoid broken HTML\n    return truncatedText;\n  };\n\n  // Handle share\n  const handleShare = async () => {\n    if (navigator.share) {\n      try {\n        await navigator.share({\n          title: post.title,\n          text: getPlainText(cleanHtmlContent(post.body)).substring(0, 100) + '...',\n          url: `${window.location.origin}/posts/${post.id}`,\n        });\n      } catch (error) {\n        console.error('Error sharing:', error);\n      }\n    } else {\n      // Fallback: copy link to clipboard\n      try {\n        await navigator.clipboard.writeText(`${window.location.origin}/posts/${post.id}`);\n        toast.success('Link copied to clipboard!');\n      } catch (error) {\n        toast.error('Failed to copy link');\n      }\n    }\n  };\n\n  // Get status badge (based on backend boolean fields)\n  const getStatusBadge = () => {\n    if (post.isArchived) {\n      return (\n        <span className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-300\">\n          <ArchiveBoxIcon className=\"h-3 w-3 mr-1\" />\n          Archived\n        </span>\n      );\n    }\n    \n    if (!post.isPublished) {\n      return (\n        <span className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-300\">\n          <ClockIcon className=\"h-3 w-3 mr-1\" />\n          Pending Review\n        </span>\n      );\n    }\n    \n    return null;\n  };\n\n  return (\n    <motion.article\n      className=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow duration-200\"\n      whileHover={{ y: -2 }}\n      layout\n    >\n      {/* Post Header */}\n      <div className=\"p-4 border-b border-gray-100 dark:border-gray-700\">\n        <div className=\"flex items-start justify-between\">\n          <div className=\"flex items-center space-x-3\">\n            {!imageError ? (\n              <img\n                src={`/api/users/profile-picture/${post.author.id}`}\n                alt={post.author.fullName}\n                className=\"h-10 w-10 rounded-full object-cover\"\n                onError={() => setImageError(true)}\n              />\n            ) : (\n              <div className=\"h-10 w-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold text-sm\">\n                {getInitials(post.author.fullName)}\n              </div>\n            )}\n            <div>\n              <Link\n                to={`/alumni/${post.author.id}`}\n                className=\"font-medium text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400\"\n              >\n                {post.author.fullName}\n              </Link>\n              {post.author.batch && (\n                <p className=\"text-sm text-gray-500 dark:text-gray-400\">Batch {post.author.batch}</p>\n              )}\n              <div className=\"flex items-center space-x-2 text-xs text-gray-500 dark:text-gray-400\">\n                <time>\n                  {formatDistanceToNow(new Date(post.createdAt), { addSuffix: true })}\n                </time>\n                {post.category && (\n                  <>\n                    <span>‚Ä¢</span>\n                    <span className=\"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300 px-2 py-1 rounded-full\">\n                      {post.category}\n                    </span>\n                  </>\n                )}\n              </div>\n            </div>\n          </div>\n\n          <div className=\"flex items-center space-x-2\">\n            {getStatusBadge()}\n            \n            {showActions && (canEdit || canDelete || canApprove) && (\n              <Menu as=\"div\" className=\"relative\">\n                <Menu.Button className=\"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700\">\n                  <EllipsisVerticalIcon className=\"h-5 w-5 text-gray-500 dark:text-gray-400\" />\n                </Menu.Button>\n\n                <Transition\n                  as={Fragment}\n                  enter=\"transition ease-out duration-100\"\n                  enterFrom=\"transform opacity-0 scale-95\"\n                  enterTo=\"transform opacity-100 scale-100\"\n                  leave=\"transition ease-in duration-75\"\n                  leaveFrom=\"transform opacity-100 scale-100\"\n                  leaveTo=\"transform opacity-0 scale-95\"\n                >\n                  <Menu.Items className=\"absolute right-0 mt-2 w-48 origin-top-right bg-white dark:bg-gray-800 rounded-md shadow-lg ring-1 ring-black ring-opacity-5 dark:ring-gray-600 focus:outline-none z-10\">\n                    <div className=\"py-1\">\n                      {canApprove && (\n                        <>\n                          <Menu.Item>\n                            {({ active }) => (\n                              <button\n                                onClick={() => onApprove?.(post.id, true)}\n                                className={`${\n                                  active ? 'bg-gray-100 dark:bg-gray-700' : ''\n                                } group flex items-center px-4 py-2 text-sm text-green-700 dark:text-green-400 w-full text-left`}\n                              >\n                                <CheckCircleIcon className=\"h-4 w-4 mr-3\" />\n                                Approve Post\n                              </button>\n                            )}\n                          </Menu.Item>\n                          <Menu.Item>\n                            {({ active }) => (\n                              <button\n                                onClick={() => onApprove?.(post.id, false)}\n                                className={`${\n                                  active ? 'bg-gray-100 dark:bg-gray-700' : ''\n                                } group flex items-center px-4 py-2 text-sm text-red-700 dark:text-red-400 w-full text-left`}\n                              >\n                                <XCircleIcon className=\"h-4 w-4 mr-3\" />\n                                Reject Post\n                              </button>\n                            )}\n                          </Menu.Item>\n                        </>\n                      )}\n                      \n                      {canEdit && (\n                        <Menu.Item>\n                          {({ active }) => (\n                            <button\n                              onClick={() => onEdit?.(post)}\n                              className={`${\n                                active ? 'bg-gray-100 dark:bg-gray-700' : ''\n                              } group flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 w-full text-left`}\n                            >\n                              <PencilIcon className=\"h-4 w-4 mr-3\" />\n                              Edit Post\n                            </button>\n                          )}\n                        </Menu.Item>\n                      )}\n\n                      {canArchive && (\n                        <Menu.Item>\n                          {({ active }) => (\n                            <button\n                              onClick={() => onArchive?.(post.id)}\n                              className={`${\n                                active ? 'bg-gray-100 dark:bg-gray-700' : ''\n                              } group flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 w-full text-left`}\n                            >\n                              <ArchiveBoxIcon className=\"h-4 w-4 mr-3\" />\n                              Archive Post\n                            </button>\n                          )}\n                        </Menu.Item>\n                      )}\n\n                      {canDelete && (\n                        <Menu.Item>\n                          {({ active }) => (\n                            <button\n                              onClick={() => onDelete?.(post.id)}\n                              className={`${\n                                active ? 'bg-gray-100 dark:bg-gray-700' : ''\n                              } group flex items-center px-4 py-2 text-sm text-red-700 dark:text-red-400 w-full text-left`}\n                            >\n                              <TrashIcon className=\"h-4 w-4 mr-3\" />\n                              Delete Post\n                            </button>\n                          )}\n                        </Menu.Item>\n                      )}\n                    </div>\n                  </Menu.Items>\n                </Transition>\n              </Menu>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Post Content */}\n      <div className=\"p-4\">\n        <div>\n          <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white mb-2\">\n            {post.title}\n          </h2>\n          \n          <div className=\"text-gray-700 dark:text-gray-300 mb-3 leading-relaxed\">\n            <div \n              className=\"prose dark:prose-invert max-w-none prose-sm\"\n              dangerouslySetInnerHTML={{\n                __html: isExpanded ? cleanHtmlContent(post.body) : getTruncatedHtml(post.body, 200)\n              }}\n            />\n            {getPlainText(post.body).length > 200 && (\n              <button\n                onClick={() => setIsExpanded(!isExpanded)}\n                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm font-medium mt-1 inline-block\"\n              >\n                {isExpanded ? 'Read less' : 'Read more'}\n              </button>\n            )}\n          </div>\n        </div>\n\n        {/* Post Images */}\n        {(post.heroImage || (post.images && post.images.length > 0)) && (\n          <PostImageDisplay\n            postId={post.id}\n            heroImage={post.heroImage}\n            images={post.images || []}\n            title={post.title}\n          />\n        )}\n\n        {/* Tags */}\n        {post.tags && post.tags.length > 0 && (\n          <div className=\"flex flex-wrap gap-2 mb-4\">\n            {post.tags.map((tag) => (\n              <span\n                key={tag}\n                className=\"inline-flex items-center px-2 py-1 rounded-md text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 cursor-pointer\"\n              >\n                #{tag}\n              </span>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* LinkedIn-style Post Actions */}\n      <div className=\"px-4 py-3\">\n        <LinkedInReactions\n          postId={post.id}\n          reactions={reactionsData.reactions}\n          userReactions={reactionsData.userReactions}\n          totalReactions={reactionsData.totalReactions}\n          recentReactions={post.recentReactions}\n          onReact={handleReaction}\n          onCommentClick={() => setShowComments(!showComments)}\n          onShareClick={handleShare}\n          commentCount={post._count?.comments || 0}\n          disabled={reactingToPost || !user}\n        />\n      </div>\n\n      {/* Comments Section */}\n      {showComments && (\n        <CommentsSection\n          postId={post.id}\n          allowComments={post.allowComments}\n        />\n      )}\n    </motion.article>\n  );\n};\n\nexport default PostCard;"],"names":["ChatBubbleLeftIcon","title","titleId","props","svgRef","React.createElement","ForwardRef","React.forwardRef","EllipsisHorizontalIcon","ShareIcon","REACTION_CONFIG","ReactionsModal","isOpen","onClose","postId","selectedTab","setSelectedTab","useState","page","setPage","reactionsData","isLoading","error","useGetPostReactionUsersQuery","getInitials","name","word","availableReactions","_","count","a","countA","b","countB","jsx","Transition","Fragment","jsxs","Dialog","XMarkIcon","reactionType","AnimatePresence","reaction","index","motion","Link","p","LinkedInReactions","reactions","userReactions","totalReactions","recentReactions","onReact","onCommentClick","onShareClick","commentCount","disabled","className","showPicker","setShowPicker","isHovering","setIsHovering","showReactionsModal","setShowReactionsModal","userReaction","hasReacted","topReactions","type","handleReactionClick","handleMainButtonClick","useEffect","timeout","getReactionText","uniqueUsers","r","config","isActive","CommentReactionsModal","commentId","useGetCommentReactionUsersQuery","sum","CommentsSection","allowComments","user","useAuth","sortOrder","setSortOrder","currentLimit","setCurrentLimit","commentsData","commentsLoading","commentsError","useGetPostCommentsQuery","createComment","creatingComment","useCreateCommentMutation","createReply","creatingReply","useCreateReplyMutation","toggleCommentReaction","useToggleCommentReactionMutation","updateComment","updatingComment","useUpdateCommentMutation","deleteComment","useDeleteCommentMutation","loadedImages","setLoadedImages","getAvatarColor","userId","colors","colorIndex","acc","char","handleImageLoad","e","img","prev","handleDeleteComment","CommentInput","placeholder","onSubmit","buttonText","autoFocus","text","setText","isFocused","setIsFocused","textareaRef","useRef","handleSubmit","useCallback","handleTextChange","target","handleKeyPress","handleFocus","handleBlur","CommentItem","React","comment","isReply","level","showReplyInput","setShowReplyInput","showReactionPicker","setShowReactionPicker","editingComment","setEditingComment","showCommentMenu","setShowCommentMenu","showAllReplies","setShowAllReplies","isAuthor","hasReplies","replyCount","handleCreateReply","content","handleReactionToggle","handleEditThisComment","handleUpdateThisComment","handleEditContentChange","value","menuRef","handleClickOutside","event","PencilIcon","TrashIcon","parent","reply","handleCreateComment","toggleSortOrder","loadMoreComments","hasMoreComments","PostCard","post","showActions","onEdit","onDelete","onArchive","onApprove","useSelector","state","showComments","setShowComments","imageError","setImageError","isExpanded","setIsExpanded","toggleLike","likingPost","useToggleLikeMutation","toggleReaction","reactingToPost","useToggleReactionMutation","canEdit","canDelete","canApprove","canArchive","handleReaction","toast","errorMessage","getPlainText","html","tempDiv","cleanHtmlContent","anchor","mentionSpan","textNode","element","style","problematicStyles","cleanedStyle","problemStyle","getTruncatedHtml","maxLength","cleanedHtml","plainText","words","truncatedText","handleShare","getStatusBadge","ArchiveBoxIcon","ClockIcon","formatDistanceToNow","Menu","EllipsisVerticalIcon","active","CheckCircleIcon","XCircleIcon","PostImageDisplay","tag"],"mappings":"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","x_google_ignoreList":[0,1,2]}