{"version":3,"file":"developerApi-Byh796EX.js","sources":["../../src/store/api/developerApi.ts"],"sourcesContent":["// src/store/api/developerApi.ts\n// Developer Portal API - For managing multi-tenant organizations\n\nimport { apiSlice } from './apiSlice'\n\n// Types\nexport interface Organization {\n  id: string\n  name: string\n  shortName: string\n  tenantCode: string\n  isActive: boolean\n  subscriptionStatus: 'TRIAL' | 'ACTIVE' | 'EXPIRED' | 'SUSPENDED'\n  subscriptionStartAt: string | null\n  subscriptionEndsAt: string | null\n  isMaintenanceMode: boolean\n  maintenanceMessage: string | null\n  maxUsers: number\n  storageQuotaMB: number\n  logoUrl: string | null\n  logoProxyUrl: string | null // Proxy URL for R2 logos\n  officialEmail: string\n  officialContactNumber: string | null\n  createdAt: string\n  updatedAt: string\n  _count?: {\n    users: number\n    events: number\n    posts: number\n  }\n}\n\nexport interface OrganizationDetails extends Organization {\n  officeAddress: string | null\n  foundationYear: number | null\n  description: string | null\n  mission: string | null\n  vision: string | null\n  _count: {\n    users: number\n    events: number\n    posts: number\n    albums: number\n    photos: number\n    transactions: number\n    notifications: number\n    groups: number\n    sponsors: number\n    polls: number\n    tickets: number\n  }\n}\n\nexport interface DeveloperDashboard {\n  organizations: {\n    total: number\n    active: number\n    inMaintenance: number\n  }\n  subscriptions: Record<string, number>\n  recentOrganizations: Organization[]\n  systemTotals: {\n    users: number\n    posts: number\n    events: number\n  }\n}\n\nexport interface OrganizationStats {\n  users: {\n    byRole: { role: string; _count: number }[]\n    total: number\n  }\n  content: {\n    posts: number\n    events: number\n    albums: number\n    photos: number\n    polls: number\n  }\n  recentActivity: {\n    action: string\n    details: Record<string, unknown>\n    createdAt: string\n    user: {\n      fullName: string\n      role: string\n    }\n  }[]\n}\n\nexport interface CreateOrganizationRequest {\n  name: string\n  shortName: string\n  tenantCode: string\n  officialEmail: string\n  officialContactNumber?: string\n  officeAddress?: string\n  foundationYear?: number\n  description?: string\n  mission?: string\n  vision?: string\n  subscriptionStatus?: 'TRIAL' | 'ACTIVE'\n  subscriptionDays?: number\n  maxUsers?: number\n  storageQuotaMB?: number\n}\n\nexport interface UpdateSubscriptionRequest {\n  subscriptionStatus?: 'TRIAL' | 'ACTIVE' | 'EXPIRED' | 'SUSPENDED'\n  subscriptionDays?: number\n  maxUsers?: number\n  storageQuotaMB?: number\n}\n\n// Email Configuration Types\nexport type EmailProvider = 'SMTP' | 'GMAIL' | 'SENDGRID' | 'RESEND' | 'MAILGUN' | 'SES' | 'MAILERSEND'\n\nexport interface EmailConfig {\n  id: string\n  organizationId: string\n  provider: EmailProvider\n  smtpHost: string | null\n  smtpPort: number | null\n  smtpSecure: boolean\n  smtpUser: string | null\n  smtpPassword: string | null // Will be masked '********' from API\n  sendgridApiKey: string | null\n  resendApiKey: string | null\n  mailgunApiKey: string | null\n  mailgunDomain: string | null\n  mailersendApiKey: string | null\n  fromEmail: string\n  fromName: string\n  replyTo: string | null\n  primaryColor: string | null\n  logoUrl: string | null\n  dailyEmailLimit: number\n  monthlyEmailLimit: number\n  dailyEmailsSent: number\n  monthlyEmailsSent: number\n  isActive: boolean\n  isVerified: boolean\n  lastTestedAt: string | null\n  verificationToken: string | null\n  organization?: {\n    name: string\n    tenantCode: string\n  }\n}\n\nexport interface DnsRecord {\n  type: string\n  name: string\n  value: string\n}\n\nexport interface DnsRecords {\n  verification: DnsRecord\n  spf: DnsRecord\n  dkim: DnsRecord\n}\n\nexport interface EmailConfigResponse {\n  config: EmailConfig | null\n  dnsRecords?: DnsRecords | null\n  message?: string\n}\n\nexport interface SaveEmailConfigRequest {\n  provider: EmailProvider\n  smtpHost?: string\n  smtpPort?: number\n  smtpSecure?: boolean\n  smtpUser?: string\n  smtpPassword?: string\n  sendgridApiKey?: string\n  resendApiKey?: string\n  mailgunApiKey?: string\n  mailgunDomain?: string\n  mailersendApiKey?: string\n  fromEmail: string\n  fromName: string\n  replyTo?: string\n  primaryColor?: string\n  logoUrl?: string\n  dailyEmailLimit?: number\n  monthlyEmailLimit?: number\n}\n\nexport interface EmailStats {\n  dailyEmailsSent: number\n  monthlyEmailsSent: number\n  dailyEmailLimit: number\n  monthlyEmailLimit: number\n  lastDailyReset: string | null\n  lastMonthlyReset: string | null\n  lastTestedAt: string | null\n  lastTestResult: string | null\n  isActive: boolean\n  isVerified: boolean\n  provider: EmailProvider\n  dailyUsagePercent: number\n  monthlyUsagePercent: number\n}\n\n// Developer API endpoints\nexport const developerApi = apiSlice.injectEndpoints({\n  endpoints: (builder) => ({\n    // Dashboard\n    getDeveloperDashboard: builder.query<DeveloperDashboard, void>({\n      query: () => '/developer/dashboard',\n      transformResponse: (response: { data: { dashboard: DeveloperDashboard } }) =>\n        response.data.dashboard,\n      providesTags: ['Organization'],\n    }),\n\n    // Switch tenant context\n    switchTenantContext: builder.mutation<\n      { organization: Organization },\n      { tenantCode: string }\n    >({\n      query: (body) => ({\n        url: '/developer/switch-tenant',\n        method: 'POST',\n        body,\n      }),\n      transformResponse: (response: { data: { organization: Organization } }) =>\n        response.data,\n    }),\n\n    // Organization CRUD - Named uniquely to avoid collision with authApi.getAllOrganizations\n    getDeveloperOrganizations: builder.query<\n      { data: Organization[]; pagination: { total: number; pages: number } },\n      { search?: string; status?: string; page?: number; limit?: number }\n    >({\n      query: (params) => ({\n        url: '/developer/organizations',\n        params,\n      }),\n      // Server returns: { success: true, data: Organization[], pagination: {...} }\n      transformResponse: (response: any) => {\n        // Handle the response - data should be array directly from paginatedResponse\n        const data = Array.isArray(response.data) ? response.data : []\n        const pagination = response.pagination || { total: 0, pages: 1 }\n        return { data, pagination }\n      },\n      providesTags: ['Organization'],\n    }),\n\n    getOrganizationById: builder.query<OrganizationDetails, string>({\n      query: (orgId) => `/developer/organizations/${orgId}`,\n      transformResponse: (response: { data: { organization: OrganizationDetails } }) =>\n        response.data.organization,\n      providesTags: (_result, _error, orgId) => [{ type: 'Organization', id: orgId }],\n    }),\n\n    createOrganization: builder.mutation<Organization, CreateOrganizationRequest>({\n      query: (body) => ({\n        url: '/developer/organizations',\n        method: 'POST',\n        body,\n      }),\n      transformResponse: (response: { data: { organization: Organization } }) =>\n        response.data.organization,\n      invalidatesTags: ['Organization'],\n    }),\n\n    updateOrganization: builder.mutation<\n      Organization,\n      { orgId: string; data: Partial<Organization> }\n    >({\n      query: ({ orgId, data }) => ({\n        url: `/developer/organizations/${orgId}`,\n        method: 'PUT',\n        body: data,\n      }),\n      transformResponse: (response: { data: { organization: Organization } }) =>\n        response.data.organization,\n      invalidatesTags: (_result, _error, { orgId }) => [\n        { type: 'Organization', id: orgId },\n        'Organization',\n      ],\n    }),\n\n    // Maintenance mode\n    toggleMaintenanceMode: builder.mutation<\n      Organization,\n      { orgId: string; isMaintenanceMode: boolean; maintenanceMessage?: string }\n    >({\n      query: ({ orgId, ...body }) => ({\n        url: `/developer/organizations/${orgId}/maintenance`,\n        method: 'POST',\n        body,\n      }),\n      transformResponse: (response: { data: { organization: Organization } }) =>\n        response.data.organization,\n      invalidatesTags: (_result, _error, { orgId }) => [\n        { type: 'Organization', id: orgId },\n        'Organization',\n      ],\n    }),\n\n    // Subscription - Legacy direct update (for quick extend/status change)\n    updateSubscription: builder.mutation<\n      Organization,\n      { orgId: string } & UpdateSubscriptionRequest\n    >({\n      query: ({ orgId, ...body }) => ({\n        url: `/developer/organizations/${orgId}/subscription-legacy`,\n        method: 'POST',\n        body,\n      }),\n      transformResponse: (response: { data: { organization: Organization } }) =>\n        response.data.organization,\n      invalidatesTags: (_result, _error, { orgId }) => [\n        { type: 'Organization', id: orgId },\n        'Organization',\n      ],\n    }),\n\n    // Statistics\n    getOrganizationStats: builder.query<OrganizationStats, string>({\n      query: (orgId) => `/developer/organizations/${orgId}/stats`,\n      transformResponse: (response: { data: { stats: OrganizationStats } }) =>\n        response.data.stats,\n    }),\n\n    // Email Configuration\n    getOrganizationEmailConfig: builder.query<EmailConfigResponse, string>({\n      query: (orgId) => `/developer/organizations/${orgId}/email-config`,\n      transformResponse: (response: { data: EmailConfigResponse }) => response.data,\n      providesTags: (_result, _error, orgId) => [{ type: 'EmailConfig' as const, id: orgId }],\n    }),\n\n    saveOrganizationEmailConfig: builder.mutation<\n      EmailConfigResponse,\n      { orgId: string; data: SaveEmailConfigRequest }\n    >({\n      query: ({ orgId, data }) => ({\n        url: `/developer/organizations/${orgId}/email-config`,\n        method: 'POST',\n        body: data,\n      }),\n      transformResponse: (response: { data: EmailConfigResponse }) => response.data,\n      invalidatesTags: (_result, _error, { orgId }) => [{ type: 'EmailConfig' as const, id: orgId }],\n    }),\n\n    testOrganizationEmailConfig: builder.mutation<\n      { success: boolean; message?: string; error?: string; testEmailSent?: boolean },\n      { orgId: string; testEmail?: string }\n    >({\n      query: ({ orgId, testEmail }) => ({\n        url: `/developer/organizations/${orgId}/email-config/test`,\n        method: 'POST',\n        body: { testEmail },\n      }),\n      transformResponse: (response: { data: { success: boolean; message?: string; testEmailSent?: boolean } }) => response.data,\n    }),\n\n    activateOrganizationEmailConfig: builder.mutation<{ success: boolean; message: string }, string>({\n      query: (orgId) => ({\n        url: `/developer/organizations/${orgId}/email-config/activate`,\n        method: 'POST',\n      }),\n      transformResponse: (response: { data: { success: boolean; message: string } }) => response.data,\n      invalidatesTags: (_result, _error, orgId) => [{ type: 'EmailConfig' as const, id: orgId }],\n    }),\n\n    deactivateOrganizationEmailConfig: builder.mutation<{ message: string }, string>({\n      query: (orgId) => ({\n        url: `/developer/organizations/${orgId}/email-config/deactivate`,\n        method: 'POST',\n      }),\n      transformResponse: (response: { data: { message: string } }) => response.data,\n      invalidatesTags: (_result, _error, orgId) => [{ type: 'EmailConfig' as const, id: orgId }],\n    }),\n\n    deleteOrganizationEmailConfig: builder.mutation<{ message: string }, string>({\n      query: (orgId) => ({\n        url: `/developer/organizations/${orgId}/email-config`,\n        method: 'DELETE',\n      }),\n      transformResponse: (response: { data: { message: string } }) => response.data,\n      invalidatesTags: (_result, _error, orgId) => [{ type: 'EmailConfig' as const, id: orgId }],\n    }),\n\n    getOrganizationEmailStats: builder.query<{ stats: EmailStats | null; message?: string }, string>({\n      query: (orgId) => `/developer/organizations/${orgId}/email-config/stats`,\n      transformResponse: (response: { data: { stats: EmailStats | null; message?: string } }) => response.data,\n    }),\n  }),\n  overrideExisting: false,\n})\n\n// Export hooks\nexport const {\n  useGetDeveloperDashboardQuery,\n  useSwitchTenantContextMutation,\n  useGetDeveloperOrganizationsQuery,\n  useGetOrganizationByIdQuery,\n  useCreateOrganizationMutation,\n  useUpdateOrganizationMutation,\n  useToggleMaintenanceModeMutation,\n  useUpdateSubscriptionMutation,\n  useGetOrganizationStatsQuery,\n  // Email Configuration hooks\n  useGetOrganizationEmailConfigQuery,\n  useSaveOrganizationEmailConfigMutation,\n  useTestOrganizationEmailConfigMutation,\n  useActivateOrganizationEmailConfigMutation,\n  useDeactivateOrganizationEmailConfigMutation,\n  useDeleteOrganizationEmailConfigMutation,\n  useGetOrganizationEmailStatsQuery,\n} = developerApi\n"],"names":["developerApi","apiSlice","builder","response","body","params","data","pagination","orgId","_result","_error","testEmail","useGetDeveloperDashboardQuery","useGetDeveloperOrganizationsQuery","useGetOrganizationByIdQuery","useCreateOrganizationMutation","useUpdateOrganizationMutation","useToggleMaintenanceModeMutation","useUpdateSubscriptionMutation","useGetOrganizationStatsQuery","useGetOrganizationEmailConfigQuery","useSaveOrganizationEmailConfigMutation","useTestOrganizationEmailConfigMutation","useActivateOrganizationEmailConfigMutation","useDeactivateOrganizationEmailConfigMutation","useDeleteOrganizationEmailConfigMutation","useGetOrganizationEmailStatsQuery"],"mappings":"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"}