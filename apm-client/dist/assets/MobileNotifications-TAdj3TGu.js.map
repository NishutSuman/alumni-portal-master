{"version":3,"file":"MobileNotifications-TAdj3TGu.js","sources":["../../src/pages/common/MobileNotifications.tsx"],"sourcesContent":["// src/pages/common/MobileNotifications.tsx\nimport React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { motion } from 'framer-motion';\nimport { \n  ArrowLeftIcon, \n  BellIcon, \n  CheckIcon, \n  TrashIcon, \n  XMarkIcon,\n  ExclamationCircleIcon,\n  CheckCircleIcon\n} from '@heroicons/react/24/outline';\nimport {\n  useGetNotificationsQuery,\n  useGetUnreadCountQuery,\n  useMarkAsReadMutation,\n  useMarkAllAsReadMutation,\n  useDeleteNotificationMutation,\n  useClearAllNotificationsMutation,\n  Notification\n} from '@/store/api/notificationApi';\nimport LoadingSpinner from '@/components/common/UI/LoadingSpinner';\n\nconst MobileNotifications: React.FC = () => {\n  const navigate = useNavigate();\n  const [filter, setFilter] = useState<'all' | 'unread'>('all');\n  \n  // Get both all notifications and unread count for proper tab counts\n  const { data: allNotificationsData, isLoading: isLoadingAll, error: errorAll } = useGetNotificationsQuery({\n    page: 1,\n    limit: 50,\n    unreadOnly: false\n  });\n  \n  const { data: unreadNotificationsData, isLoading: isLoadingUnread, error: errorUnread } = useGetNotificationsQuery({\n    page: 1,\n    limit: 50,\n    unreadOnly: true\n  });\n  \n  const { data: unreadCountData } = useGetUnreadCountQuery();\n\n  // Use appropriate data based on filter\n  const notificationsData = filter === 'all' ? allNotificationsData : unreadNotificationsData;\n  const isLoading = filter === 'all' ? isLoadingAll : isLoadingUnread;\n  const error = filter === 'all' ? errorAll : errorUnread;\n  const [markAsRead] = useMarkAsReadMutation();\n  const [markAllAsRead] = useMarkAllAsReadMutation();\n  const [deleteNotification] = useDeleteNotificationMutation();\n  const [clearAllNotifications, { isLoading: isClearingAll }] = useClearAllNotificationsMutation();\n\n  const notifications = notificationsData?.notifications || [];\n  const allNotifications = allNotificationsData?.notifications || [];\n  const unreadNotifications = unreadNotificationsData?.notifications || [];\n  const unreadCount = unreadCountData?.count || 0;\n  \n  // Get accurate counts for tabs\n  const allCount = allNotifications.length;\n  const unreadCountForTab = unreadNotifications.length;\n\n  const handleMarkAsRead = async (notificationId: string) => {\n    try {\n      await markAsRead(notificationId).unwrap();\n    } catch (error) {\n      console.error('Failed to mark notification as read:', error);\n    }\n  };\n\n  const handleMarkAllAsRead = async () => {\n    try {\n      await markAllAsRead().unwrap();\n    } catch (error) {\n      console.error('Failed to mark all notifications as read:', error);\n    }\n  };\n\n  const handleDeleteNotification = async (notificationId: string) => {\n    try {\n      await deleteNotification(notificationId).unwrap();\n    } catch (error) {\n      console.error('Failed to delete notification:', error);\n    }\n  };\n\n  const handleClearAll = async () => {\n    if (!confirm('Are you sure you want to delete all notifications? This action cannot be undone.')) {\n      return;\n    }\n    \n    try {\n      const result = await clearAllNotifications().unwrap();\n      console.log(`Successfully cleared ${result.deletedCount} notifications`);\n    } catch (error) {\n      console.error('Failed to clear all notifications:', error);\n      const errorMessage = error?.data?.message || 'Failed to clear notifications';\n      alert(`Error: ${errorMessage}`);\n    }\n  };\n\n  const getNotificationIcon = (type: string) => {\n    switch (type) {\n      case 'NEW_REGISTRATION':\n      case 'VERIFICATION_APPROVED':\n      case 'ROLE_UPDATED':\n        return <CheckCircleIcon className=\"h-5 w-5 text-green-500\" />;\n      case 'ACCOUNT_SUSPENDED':\n      case 'VERIFICATION_REJECTED':\n        return <ExclamationCircleIcon className=\"h-5 w-5 text-red-500\" />;\n      default:\n        return <BellIcon className=\"h-5 w-5 text-blue-500\" />;\n    }\n  };\n\n  const getPriorityColor = (priority: string) => {\n    switch (priority) {\n      case 'EMERGENCY':\n        return 'text-red-600 dark:text-red-400';\n      case 'HIGH':\n        return 'text-orange-600 dark:text-orange-400';\n      case 'NORMAL':\n        return 'text-blue-600 dark:text-blue-400';\n      case 'LOW':\n        return 'text-gray-600 dark:text-gray-400';\n      default:\n        return 'text-gray-600 dark:text-gray-400';\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center\">\n        <LoadingSpinner />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 pb-20 pt-16\">\n      {/* Header with close button */}\n      <div className=\"fixed top-0 left-0 right-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 z-10\">\n        <div className=\"flex items-center justify-between px-4 py-3\">\n          <h1 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n            Notifications\n          </h1>\n          <button\n            onClick={() => navigate(-1)}\n            className=\"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors\"\n            title=\"Close notifications\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n      </div>\n\n      {/* Notifications Content */}\n      <div className=\"px-4 pt-4\">\n        {/* Filter Tabs */}\n        <div className=\"flex space-x-1 bg-gray-100 dark:bg-gray-700 p-1 rounded-lg\">\n            <button\n              onClick={() => setFilter('all')}\n              className={`flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors ${\n                filter === 'all'\n                  ? 'bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow'\n                  : 'text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200'\n              }`}\n            >\n              All ({allCount})\n            </button>\n            <button\n              onClick={() => setFilter('unread')}\n              className={`flex-1 py-2 px-4 text-sm font-medium rounded-md transition-colors ${\n                filter === 'unread'\n                  ? 'bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow'\n                  : 'text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200'\n              }`}\n            >\n              Unread ({unreadCountForTab})\n            </button>\n          </div>\n          \n          {/* Action Buttons */}\n          {notifications.length > 0 && (\n            <div className=\"flex justify-between mt-4 space-x-3\">\n              {unreadCount > 0 && (\n                <button\n                  onClick={handleMarkAllAsRead}\n                  className=\"flex-1 px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 border border-blue-600 dark:border-blue-400 rounded-lg transition-colors\"\n                >\n                  Mark All Read\n                </button>\n              )}\n              <button\n                onClick={handleClearAll}\n                disabled={isClearingAll}\n                className=\"flex-1 px-4 py-2 text-sm font-medium text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 border border-red-600 dark:border-red-400 rounded-lg transition-colors disabled:opacity-50\"\n              >\n                {isClearingAll ? 'Clearing...' : 'Clear All'}\n              </button>\n            </div>\n          )}\n\n        {/* Notifications List */}\n        <div className=\"mt-4\">\n        {error ? (\n          <div className=\"text-center py-8\">\n            <ExclamationCircleIcon className=\"h-12 w-12 text-red-500 mx-auto mb-4\" />\n            <p className=\"text-gray-600 dark:text-gray-400\">Failed to load notifications</p>\n          </div>\n        ) : notifications.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <BellIcon className=\"h-16 w-16 text-gray-300 dark:text-gray-600 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\n              No notifications\n            </h3>\n            <p className=\"text-gray-500 dark:text-gray-400\">\n              {filter === 'unread' ? 'No unread notifications' : 'No notifications yet'}\n            </p>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {notifications.map((notification) => (\n              <motion.div\n                key={notification.id}\n                layout\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                exit={{ opacity: 0, y: -20 }}\n                className={`bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700 ${\n                  !notification.isRead ? 'ring-2 ring-blue-500 ring-opacity-20' : ''\n                }`}\n              >\n                <div className=\"flex items-start space-x-3\">\n                  <div className=\"flex-shrink-0 mt-1\">\n                    {getNotificationIcon(notification.type)}\n                  </div>\n                  \n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <h4 className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                          {notification.title}\n                        </h4>\n                        <p className=\"text-sm text-gray-600 dark:text-gray-300 mt-1\">\n                          {notification.message}\n                        </p>\n                        \n                        <div className=\"flex items-center mt-2 space-x-4\">\n                          <time className=\"text-xs text-gray-500 dark:text-gray-400\">\n                            {new Date(notification.createdAt).toLocaleString()}\n                          </time>\n                          <span className={`text-xs font-medium ${getPriorityColor(notification.priority)}`}>\n                            {notification.priority}\n                          </span>\n                        </div>\n                      </div>\n                      \n                      <div className=\"flex items-center space-x-2 ml-4\">\n                        {!notification.isRead && (\n                          <button\n                            onClick={() => handleMarkAsRead(notification.id)}\n                            className=\"p-1.5 text-green-600 hover:bg-green-50 dark:text-green-400 dark:hover:bg-green-900/20 rounded-md transition-colors\"\n                            title=\"Mark as read\"\n                          >\n                            <CheckIcon className=\"h-4 w-4\" />\n                          </button>\n                        )}\n                        <button\n                          onClick={() => handleDeleteNotification(notification.id)}\n                          className=\"p-1.5 text-red-600 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900/20 rounded-md transition-colors\"\n                          title=\"Delete\"\n                        >\n                          <TrashIcon className=\"h-4 w-4\" />\n                        </button>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </motion.div>\n            ))}\n          </div>\n        )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default MobileNotifications;"],"names":["MobileNotifications","navigate","useNavigate","filter","setFilter","useState","allNotificationsData","isLoadingAll","errorAll","useGetNotificationsQuery","unreadNotificationsData","isLoadingUnread","errorUnread","unreadCountData","useGetUnreadCountQuery","notificationsData","isLoading","error","markAsRead","useMarkAsReadMutation","markAllAsRead","useMarkAllAsReadMutation","deleteNotification","useDeleteNotificationMutation","clearAllNotifications","isClearingAll","useClearAllNotificationsMutation","notifications","allNotifications","unreadNotifications","unreadCount","allCount","unreadCountForTab","handleMarkAsRead","notificationId","handleMarkAllAsRead","handleDeleteNotification","handleClearAll","result","errorMessage","getNotificationIcon","type","jsx","CheckCircleIcon","ExclamationCircleIcon","BellIcon","getPriorityColor","priority","LoadingSpinner","jsxs","XMarkIcon","notification","motion","CheckIcon","TrashIcon"],"mappings":"glBAwBA,MAAMA,GAAgC,IAAM,CAC1C,MAAMC,EAAWC,EAAA,EACX,CAACC,EAAQC,CAAS,EAAIC,EAAAA,SAA2B,KAAK,EAGtD,CAAE,KAAMC,EAAsB,UAAWC,EAAc,MAAOC,CAAA,EAAaC,EAAyB,CACxG,KAAM,EACN,MAAO,GACP,WAAY,EAAA,CACb,EAEK,CAAE,KAAMC,EAAyB,UAAWC,EAAiB,MAAOC,CAAA,EAAgBH,EAAyB,CACjH,KAAM,EACN,MAAO,GACP,WAAY,EAAA,CACb,EAEK,CAAE,KAAMI,CAAA,EAAoBC,EAAA,EAG5BC,EAAoBZ,IAAW,MAAQG,EAAuBI,EAC9DM,EAAYb,IAAW,MAAQI,EAAeI,EAC9CM,EAAQd,IAAW,MAAQK,EAAWI,EACtC,CAACM,CAAU,EAAIC,EAAA,EACf,CAACC,CAAa,EAAIC,EAAA,EAClB,CAACC,CAAkB,EAAIC,EAAA,EACvB,CAACC,EAAuB,CAAE,UAAWC,CAAA,CAAe,EAAIC,EAAA,EAExDC,EAAgBZ,GAAmB,eAAiB,CAAA,EACpDa,EAAmBtB,GAAsB,eAAiB,CAAA,EAC1DuB,EAAsBnB,GAAyB,eAAiB,CAAA,EAChEoB,EAAcjB,GAAiB,OAAS,EAGxCkB,EAAWH,EAAiB,OAC5BI,EAAoBH,EAAoB,OAExCI,EAAmB,MAAOC,GAA2B,CACzD,GAAI,CACF,MAAMhB,EAAWgB,CAAc,EAAE,OAAA,CACnC,OAASjB,EAAO,CACd,QAAQ,MAAM,uCAAwCA,CAAK,CAC7D,CACF,EAEMkB,EAAsB,SAAY,CACtC,GAAI,CACF,MAAMf,EAAA,EAAgB,OAAA,CACxB,OAASH,EAAO,CACd,QAAQ,MAAM,4CAA6CA,CAAK,CAClE,CACF,EAEMmB,EAA2B,MAAOF,GAA2B,CACjE,GAAI,CACF,MAAMZ,EAAmBY,CAAc,EAAE,OAAA,CAC3C,OAASjB,EAAO,CACd,QAAQ,MAAM,iCAAkCA,CAAK,CACvD,CACF,EAEMoB,EAAiB,SAAY,CACjC,GAAK,QAAQ,kFAAkF,EAI/F,GAAI,CACF,MAAMC,EAAS,MAAMd,EAAA,EAAwB,OAAA,EAC7C,QAAQ,IAAI,wBAAwBc,EAAO,YAAY,gBAAgB,CACzE,OAASrB,EAAO,CACd,QAAQ,MAAM,qCAAsCA,CAAK,EACzD,MAAMsB,EAAetB,GAAO,MAAM,SAAW,gCAC7C,MAAM,UAAUsB,CAAY,EAAE,CAChC,CACF,EAEMC,EAAuBC,GAAiB,CAC5C,OAAQA,EAAA,CACN,IAAK,mBACL,IAAK,wBACL,IAAK,eACH,OAAOC,EAAAA,IAACC,EAAA,CAAgB,UAAU,wBAAA,CAAyB,EAC7D,IAAK,oBACL,IAAK,wBACH,OAAOD,EAAAA,IAACE,EAAA,CAAsB,UAAU,sBAAA,CAAuB,EACjE,QACE,OAAOF,EAAAA,IAACG,EAAA,CAAS,UAAU,uBAAA,CAAwB,CAAA,CAEzD,EAEMC,EAAoBC,GAAqB,CAC7C,OAAQA,EAAA,CACN,IAAK,YACH,MAAO,iCACT,IAAK,OACH,MAAO,uCACT,IAAK,SACH,MAAO,mCACT,IAAK,MACH,MAAO,mCACT,QACE,MAAO,kCAAA,CAEb,EAEA,OAAI/B,QAEC,MAAA,CAAI,UAAU,4EACb,SAAA0B,MAACM,IAAe,EAClB,EAKFC,EAAAA,KAAC,MAAA,CAAI,UAAU,uDAEb,SAAA,CAAAP,EAAAA,IAAC,OAAI,UAAU,0GACb,SAAAO,EAAAA,KAAC,MAAA,CAAI,UAAU,8CACb,SAAA,CAAAP,EAAAA,IAAC,KAAA,CAAG,UAAU,sDAAsD,SAAA,gBAEpE,EACAA,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMzC,EAAS,EAAE,EAC1B,UAAU,+GACV,MAAM,sBAEN,SAAAyC,EAAAA,IAACQ,EAAA,CAAU,UAAU,SAAA,CAAU,CAAA,CAAA,CACjC,CAAA,CACF,CAAA,CACF,EAGAD,EAAAA,KAAC,MAAA,CAAI,UAAU,YAEb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,6DACX,SAAA,CAAAA,EAAAA,KAAC,SAAA,CACC,QAAS,IAAM7C,EAAU,KAAK,EAC9B,UAAW,qEACTD,IAAW,MACP,iEACA,+EACN,GACD,SAAA,CAAA,QACO4B,EAAS,GAAA,CAAA,CAAA,EAEjBkB,EAAAA,KAAC,SAAA,CACC,QAAS,IAAM7C,EAAU,QAAQ,EACjC,UAAW,qEACTD,IAAW,SACP,iEACA,+EACN,GACD,SAAA,CAAA,WACU6B,EAAkB,GAAA,CAAA,CAAA,CAC7B,EACF,EAGCL,EAAc,OAAS,GACtBsB,EAAAA,KAAC,MAAA,CAAI,UAAU,sCACZ,SAAA,CAAAnB,EAAc,GACbY,EAAAA,IAAC,SAAA,CACC,QAASP,EACT,UAAU,8LACX,SAAA,eAAA,CAAA,EAIHO,EAAAA,IAAC,SAAA,CACC,QAASL,EACT,SAAUZ,EACV,UAAU,4MAET,WAAgB,cAAgB,WAAA,CAAA,CACnC,EACF,EAIJiB,EAAAA,IAAC,OAAI,UAAU,OACd,WACCO,EAAAA,KAAC,MAAA,CAAI,UAAU,mBACb,SAAA,CAAAP,EAAAA,IAACE,EAAA,CAAsB,UAAU,qCAAA,CAAsC,EACvEF,EAAAA,IAAC,IAAA,CAAE,UAAU,mCAAmC,SAAA,8BAAA,CAA4B,CAAA,EAC9E,EACEf,EAAc,SAAW,EAC3BsB,OAAC,MAAA,CAAI,UAAU,oBACb,SAAA,CAAAP,EAAAA,IAACG,EAAA,CAAS,UAAU,yDAAA,CAA0D,EAC9EH,EAAAA,IAAC,KAAA,CAAG,UAAU,yDAAyD,SAAA,mBAEvE,QACC,IAAA,CAAE,UAAU,mCACV,SAAAvC,IAAW,SAAW,0BAA4B,sBAAA,CACrD,CAAA,CAAA,CACF,QAEC,MAAA,CAAI,UAAU,YACZ,SAAAwB,EAAc,IAAKwB,GAClBT,EAAAA,IAACU,EAAO,IAAP,CAEC,OAAM,GACN,QAAS,CAAE,QAAS,EAAG,EAAG,EAAA,EAC1B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAA,EAC1B,KAAM,CAAE,QAAS,EAAG,EAAG,GAAA,EACvB,UAAW,wFACRD,EAAa,OAAkD,GAAzC,sCACzB,GAEA,SAAAF,EAAAA,KAAC,MAAA,CAAI,UAAU,6BACb,SAAA,CAAAP,MAAC,OAAI,UAAU,qBACZ,SAAAF,EAAoBW,EAAa,IAAI,EACxC,QAEC,MAAA,CAAI,UAAU,iBACb,SAAAF,EAAAA,KAAC,MAAA,CAAI,UAAU,mCACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,SACb,SAAA,CAAAP,EAAAA,IAAC,KAAA,CAAG,UAAU,oDACX,SAAAS,EAAa,MAChB,EACAT,EAAAA,IAAC,IAAA,CAAE,UAAU,gDACV,WAAa,QAChB,EAEAO,EAAAA,KAAC,MAAA,CAAI,UAAU,mCACb,SAAA,CAAAP,EAAAA,IAAC,OAAA,CAAK,UAAU,2CACb,SAAA,IAAI,KAAKS,EAAa,SAAS,EAAE,eAAA,CAAe,CACnD,EACAT,EAAAA,IAAC,OAAA,CAAK,UAAW,uBAAuBI,EAAiBK,EAAa,QAAQ,CAAC,GAC5E,SAAAA,EAAa,QAAA,CAChB,CAAA,CAAA,CACF,CAAA,EACF,EAEAF,EAAAA,KAAC,MAAA,CAAI,UAAU,mCACZ,SAAA,CAAA,CAACE,EAAa,QACbT,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMT,EAAiBkB,EAAa,EAAE,EAC/C,UAAU,qHACV,MAAM,eAEN,SAAAT,EAAAA,IAACW,EAAA,CAAU,UAAU,SAAA,CAAU,CAAA,CAAA,EAGnCX,EAAAA,IAAC,SAAA,CACC,QAAS,IAAMN,EAAyBe,EAAa,EAAE,EACvD,UAAU,6GACV,MAAM,SAEN,SAAAT,EAAAA,IAACY,EAAA,CAAU,UAAU,SAAA,CAAU,CAAA,CAAA,CACjC,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EAtDKH,EAAa,EAAA,CAwDrB,EACH,CAAA,CAEF,CAAA,CAAA,CACF,CAAA,EACF,CAEJ"}