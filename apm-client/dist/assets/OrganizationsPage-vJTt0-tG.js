import{j as e}from"./ui-BlmhFX_F.js";import{u as E,r as d}from"./router-DFnE1L-t.js";import{$ as n,o as F}from"./index-DLsoxDpQ.js";import{a as D,b as M,c as z,d as A}from"./developerApi-CV-I0x2S.js";import{L as O}from"./LoadingSpinner-BR8iBbEe.js";import{F as h}from"./PlusIcon-B6tiF6Nj.js";import{F as U}from"./MagnifyingGlassIcon-C2UCCqkW.js";import{F as R}from"./BuildingOffice2Icon-DJ0Rj8rD.js";import{F as $}from"./ChevronRightIcon-CdFql2QB.js";import{F as I}from"./WrenchScrewdriverIcon-Dg4nqSXX.js";import{F as T}from"./UsersIcon-Ct2fUG5g.js";import{F as L}from"./CalendarIcon-CroBm0p_.js";import{F as P}from"./XMarkIcon-D1c1wIzV.js";import"./redux-VN59sPcb.js";import"./vendor-gH-7aFTg.js";const V=i=>i.logoUrl?`${F().replace(/\/api$/,"")}/api/organizations/${i.id}/files/logo`:null,Y={TRIAL:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",ACTIVE:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",EXPIRED:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",SUSPENDED:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"},q={TRIAL:"bg-yellow-500",ACTIVE:"bg-green-500",EXPIRED:"bg-red-500",SUSPENDED:"bg-gray-500"};function ne(){const i=E(),[c,s]=d.useState(!1),[g,p]=d.useState(""),[x,y]=d.useState(""),{data:l,isLoading:f,error:m,refetch:u}=D({search:g||void 0,status:x||void 0,limit:50}),[j,{isLoading:b}]=M(),[k]=z(),[w]=A(),N=async r=>{r.preventDefault();const a=new FormData(r.currentTarget);try{await j({name:a.get("name"),shortName:a.get("shortName"),tenantCode:a.get("tenantCode").toUpperCase(),officialEmail:a.get("officialEmail"),foundationYear:parseInt(a.get("foundationYear")),subscriptionDays:parseInt(a.get("subscriptionDays"))||30,maxUsers:parseInt(a.get("maxUsers"))||500}).unwrap(),n.success("Organization created successfully!"),s(!1),u()}catch(t){n.error(t?.data?.message||"Failed to create organization"),console.error("Failed to create organization:",t)}},v=async(r,a,t)=>{r.stopPropagation();try{await k({orgId:a,isMaintenanceMode:!t}).unwrap(),n.success(t?"Maintenance mode disabled":"Maintenance mode enabled")}catch(o){n.error(o?.data?.message||"Failed to toggle maintenance mode")}},C=async(r,a)=>{r.stopPropagation();try{await w({orgId:a,subscriptionDays:30,subscriptionStatus:"ACTIVE"}).unwrap(),n.success("Subscription extended by 30 days")}catch(t){n.error(t?.data?.message||"Failed to extend subscription")}},S=r=>{i(`/developer/organizations/${r}`)};return f?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsx(O,{})}):m?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] p-6",children:[e.jsx("div",{className:"text-red-500 text-lg mb-4",children:"Failed to load organizations"}),e.jsx("div",{className:"text-gray-500 text-sm mb-4",children:JSON.stringify(m)}),e.jsx("button",{onClick:()=>u(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]}):e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Organizations"}),e.jsx("p",{className:"mt-1 text-gray-600 dark:text-gray-400",children:"Manage tenant organizations and their subscriptions"})]}),e.jsxs("button",{onClick:()=>s(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[e.jsx(h,{className:"h-5 w-5 mr-2"}),"New Organization"]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search organizations...",value:g,onChange:r=>p(r.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:x,onChange:r=>y(r.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"TRIAL",children:"Trial"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"EXPIRED",children:"Expired"}),e.jsx("option",{value:"SUSPENDED",children:"Suspended"})]})]})}),!Array.isArray(l?.data)||l.data.length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-12 text-center",children:[e.jsx(R,{className:"h-16 w-16 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No organizations yet"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Create your first tenant organization to get started"}),e.jsxs("button",{onClick:()=>s(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(h,{className:"h-5 w-5 mr-2"}),"Create Organization"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.isArray(l?.data)&&l.data.map(r=>{const a=V(r);return e.jsxs("div",{onClick:()=>S(r.id),className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 hover:shadow-lg hover:border-blue-300 dark:hover:border-blue-600 transition-all duration-200 cursor-pointer group overflow-hidden",children:[e.jsx("div",{className:"p-5 border-b border-gray-100 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-4 min-w-0 flex-1",children:[e.jsxs("div",{className:"flex-shrink-0",children:[a?e.jsx("img",{className:"h-14 w-14 rounded-lg object-cover shadow-sm",src:a,alt:r.name,onError:t=>{t.target.style.display="none";const o=t.target.nextElementSibling;o&&(o.style.display="flex")}}):null,e.jsx("div",{className:`h-14 w-14 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 items-center justify-center shadow-sm ${a?"hidden":"flex"}`,children:e.jsx("span",{className:"text-xl font-bold text-white",children:r.shortName.charAt(0)})})]}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white line-clamp-2 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:r.name}),e.jsx("code",{className:"text-xs px-2 py-0.5 bg-gray-100 dark:bg-gray-700 rounded font-mono text-gray-600 dark:text-gray-400",children:r.tenantCode})]})]}),e.jsx($,{className:"h-5 w-5 flex-shrink-0 text-gray-400 group-hover:text-blue-500 group-hover:translate-x-1 transition-all"})]})}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${Y[r.subscriptionStatus]}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full mr-1.5 ${q[r.subscriptionStatus]}`}),r.subscriptionStatus]}),r.isMaintenanceMode&&e.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200 rounded-full text-xs font-medium",children:[e.jsx(I,{className:"h-3 w-3 mr-1"}),"Maintenance"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(T,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("span",{children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:r._count?.users||0}),e.jsxs("span",{className:"text-gray-400",children:[" / ",r.maxUsers]})]})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(L,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsx("span",{children:r.subscriptionEndsAt?new Date(r.subscriptionEndsAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"No expiry"})]})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate mb-4",children:r.officialEmail}),e.jsxs("div",{className:"flex gap-2 pt-3 border-t border-gray-100 dark:border-gray-700",children:[e.jsx("button",{onClick:t=>v(t,r.id,r.isMaintenanceMode),className:`flex-1 px-3 py-2 rounded-lg text-xs font-medium transition-colors ${r.isMaintenanceMode?"bg-green-100 text-green-800 hover:bg-green-200 dark:bg-green-900/50 dark:text-green-200 dark:hover:bg-green-900":"bg-orange-100 text-orange-800 hover:bg-orange-200 dark:bg-orange-900/50 dark:text-orange-200 dark:hover:bg-orange-900"}`,children:r.isMaintenanceMode?"Enable":"Maintenance"}),e.jsx("button",{onClick:t=>C(t,r.id),className:"flex-1 px-3 py-2 bg-blue-100 text-blue-800 hover:bg-blue-200 dark:bg-blue-900/50 dark:text-blue-200 dark:hover:bg-blue-900 rounded-lg text-xs font-medium transition-colors",children:"+30 Days"})]})]})]},r.id)})}),c&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>s(!1)}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Create New Organization"}),e.jsx("button",{onClick:()=>s(!1),className:"p-1 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Organization Name *"}),e.jsx("input",{type:"text",name:"name",required:!0,placeholder:"e.g., ABC School Alumni",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Short Name *"}),e.jsx("input",{type:"text",name:"shortName",required:!0,placeholder:"e.g., ABC",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Tenant Code * ",e.jsx("span",{className:"text-xs text-gray-500",children:"(e.g., SCHOOL-ABC)"})]}),e.jsx("input",{type:"text",name:"tenantCode",required:!0,pattern:"[A-Za-z0-9-]+",placeholder:"SCHOOL-ABC",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white uppercase focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Official Email *"}),e.jsx("input",{type:"email",name:"officialEmail",required:!0,placeholder:"admin@school.com",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Foundation Year *"}),e.jsx("input",{type:"number",name:"foundationYear",required:!0,min:1800,max:new Date().getFullYear(),defaultValue:new Date().getFullYear(),placeholder:"e.g., 1995",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Trial Days"}),e.jsx("input",{type:"number",name:"subscriptionDays",defaultValue:30,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Max Users"}),e.jsx("input",{type:"number",name:"maxUsers",defaultValue:500,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:b,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:b?"Creating...":"Create Organization"})]})]})]})]})})]})})}export{ne as default};
//# sourceMappingURL=OrganizationsPage-vJTt0-tG.js.map
